

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>&lt;no title&gt; &mdash; pymc3 3.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="pymc3 3.0 documentation" href="../../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../docs/source/index.html" class="icon icon-home"> pymc3
          

          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../docs/source/getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/source/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/source/api.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../docs/source/index.html">pymc3</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../docs/source/index.html">Docs</a> &raquo;</li>
      
    <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/pymc3/examples/Untitled1.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class^=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: #D84315;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span>  <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pymc3</span>
<span class="kn">import</span> <span class="nn">theano</span>
<span class="kn">from</span> <span class="nn">theano.tensor</span> <span class="kn">import</span> <span class="n">eq</span>
<span class="kn">from</span> <span class="nn">theano.ifelse</span> <span class="kn">import</span> <span class="n">ifelse</span>

<span class="n">theano</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
<span class="n">theano</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">exception_verbosity</span> <span class="o">=</span> <span class="s1">&#39;high&#39;</span>
<span class="n">theano</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;DebugMode&#39;</span>
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
Couldn&#39;t import dot_parser, loading of dot files will not be possible.
</pre></div></div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="stderr container">
<div class="highlight"><pre>
Using gpu device 0: NVS 5200M
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="n">num_states</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">num_times</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">num_emissions</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">example_observation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_emissions</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">num_times</span><span class="p">)</span>
<span class="k">print</span> <span class="n">example_observation</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
[0 0 1 0 0 0 0 1 0 1]
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[12]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>array([ 1.,  1.])
</pre></div>
</div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">pymc3</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">hmm</span><span class="p">:</span>
    <span class="c1"># Transition &quot;matrix&quot;</span>
    <span class="n">a_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">num_states</span><span class="p">,</span> <span class="n">num_states</span><span class="p">))</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">pymc3</span><span class="o">.</span><span class="n">Dirichlet</span><span class="p">(</span><span class="s1">&#39;T{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">a</span><span class="o">=</span><span class="n">a_t</span><span class="p">)</span>
    <span class="c1"># Emission &quot;matrix&quot;</span>
    <span class="n">a_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">num_emissions</span><span class="p">,</span> <span class="n">num_emissions</span><span class="p">))</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">pymc3</span><span class="o">.</span><span class="n">Dirichlet</span><span class="p">(</span><span class="s1">&#39;E{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">a</span><span class="o">=</span><span class="n">a_e</span><span class="p">)</span>
    <span class="c1"># State models</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_states</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_states</span>
    <span class="c1"># No shape, so each state is a scalar tensor</span>
    <span class="n">states</span> <span class="o">=</span> <span class="n">pymc3</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p0</span><span class="p">)</span>
    <span class="n">emissions</span> <span class="o">=</span> <span class="n">pymc3</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;z0&#39;</span><span class="p">,</span>
                                  <span class="n">p</span><span class="o">=</span><span class="n">ifelse</span><span class="p">(</span><span class="n">eq</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ifelse</span><span class="p">(</span><span class="n">eq</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span>
                                  <span class="n">observed</span><span class="o">=</span><span class="n">example_observation</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_times</span><span class="p">):</span>
        <span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pymc3</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;s{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                                        <span class="n">p</span> <span class="o">=</span> <span class="n">ifelse</span><span class="p">(</span><span class="n">eq</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ifelse</span><span class="p">(</span><span class="n">eq</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]))))</span>
        <span class="n">emissions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pymc3</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;z{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                                        <span class="n">p</span><span class="o">=</span><span class="n">ifelse</span><span class="p">(</span><span class="n">eq</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ifelse</span><span class="p">(</span><span class="n">eq</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span>
                                        <span class="n">observed</span><span class="o">=</span><span class="n">example_observation</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

    <span class="c1">#print(hmm.test_point)</span>
    <span class="c1">#print(hmm)</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="n">pymc3</span><span class="o">.</span><span class="n">Metropolis</span><span class="p">()</span>
    <span class="c1">#steps += [pymc3.ElemwiseCategoricalStep(var = states[i], values = range(num_states)) for i in xrange(num_times)]</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">pymc3</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>

    <span class="n">pymc3</span><span class="o">.</span><span class="n">traceplot</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-18-51a8d2b0066b&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">      2</span>     <span class="ansi-red-intense-fg ansi-bold"># Transition &#34;matrix&#34;</span>
<span class="ansi-green-fg">      3</span>     a_t <span class="ansi-yellow-intense-fg ansi-bold">=</span> np<span class="ansi-yellow-intense-fg ansi-bold">.</span>ones<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">(</span>num_states<span class="ansi-yellow-intense-fg ansi-bold">,</span> num_states<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 4</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>T <span class="ansi-yellow-intense-fg ansi-bold">=</span> pymc3<span class="ansi-yellow-intense-fg ansi-bold">.</span>Dirichlet<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;T{0}&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>format<span class="ansi-yellow-intense-fg ansi-bold">(</span>i<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> a<span class="ansi-yellow-intense-fg ansi-bold">=</span>a_t<span class="ansi-yellow-intense-fg ansi-bold">,</span> shape<span class="ansi-yellow-intense-fg ansi-bold">=</span>a_t<span class="ansi-yellow-intense-fg ansi-bold">.</span>shape<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">      5</span>     <span class="ansi-red-intense-fg ansi-bold"># Emission &#34;matrix&#34;</span>
<span class="ansi-green-fg">      6</span>     a_e <span class="ansi-yellow-intense-fg ansi-bold">=</span> np<span class="ansi-yellow-intense-fg ansi-bold">.</span>ones<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">(</span>num_emissions<span class="ansi-yellow-intense-fg ansi-bold">,</span> num_emissions<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">__new__</span><span class="ansi-blue-intense-fg ansi-bold">(cls, name, *args, **kwargs)</span>
<span class="ansi-green-fg">     17</span>             data <span class="ansi-yellow-intense-fg ansi-bold">=</span> kwargs<span class="ansi-yellow-intense-fg ansi-bold">.</span>pop<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;observed&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> None<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     18</span>             dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> cls<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 19</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> data<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     20</span>         <span class="ansi-green-intense-fg ansi-bold">elif</span> name <span class="ansi-green-intense-fg ansi-bold">is</span> None<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     21</span>             <span class="ansi-green-intense-fg ansi-bold">return</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-red-intense-fg ansi-bold">#for pickle</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">Var</span><span class="ansi-blue-intense-fg ansi-bold">(self, name, dist, data)</span>
<span class="ansi-green-fg">    151</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>free_RVs<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    152</span>             <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 153</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>var <span class="ansi-yellow-intense-fg ansi-bold">=</span> TransformedRV<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">=</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> model<span class="ansi-yellow-intense-fg ansi-bold">=</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>transform<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    154</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>deterministics<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    155</span>                 <span class="ansi-green-intense-fg ansi-bold">return</span> var

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, type, owner, index, name, distribution, model, transform)</span>
<span class="ansi-green-fg">    506</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>model <span class="ansi-yellow-intense-fg ansi-bold">=</span> model
<span class="ansi-green-fg">    507</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 508</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed <span class="ansi-yellow-intense-fg ansi-bold">=</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name <span class="ansi-yellow-intense-fg ansi-bold">+</span> <span class="ansi-blue-intense-fg ansi-bold">&#34;_&#34;</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>distribution<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    509</span>
<span class="ansi-green-fg">    510</span>             normalRV <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>backward<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">apply</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist)</span>
<span class="ansi-green-fg">     23</span>
<span class="ansi-green-fg">     24</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 25</span><span class="ansi-yellow-intense-fg ansi-bold">         </span><span class="ansi-green-intense-fg ansi-bold">return</span> TransformedDistribution<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     26</span>
<span class="ansi-green-fg">     27</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> __str__<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">dist</span><span class="ansi-blue-intense-fg ansi-bold">(cls, *args, **kwargs)</span>
<span class="ansi-green-fg">     29</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     30</span>         dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 31</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>__init__<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     32</span>         <span class="ansi-green-intense-fg ansi-bold">return</span> dist
<span class="ansi-green-fg">     33</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist, transform, *args, **kwargs)</span>
<span class="ansi-green-fg">     46</span>             arguments to Distribution&#34;&#34;&#34;
<span class="ansi-green-fg">     47</span>         forward <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>forward
<span class="ansi-green-intense-fg ansi-bold">---&gt; 48</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>testval <span class="ansi-yellow-intense-fg ansi-bold">=</span> forward<span class="ansi-yellow-intense-fg ansi-bold">(</span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>default<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     49</span>
<span class="ansi-green-fg">     50</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> dist

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-intense-fg ansi-bold">(self, x)</span>
<span class="ansi-green-fg">    151</span>         <span class="ansi-red-intense-fg ansi-bold">#reverse cumsum</span>
<span class="ansi-green-fg">    152</span>         x0 <span class="ansi-yellow-intense-fg ansi-bold">=</span> x<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 153</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>s <span class="ansi-yellow-intense-fg ansi-bold">=</span> t<span class="ansi-yellow-intense-fg ansi-bold">.</span>extra_ops<span class="ansi-yellow-intense-fg ansi-bold">.</span>cumsum<span class="ansi-yellow-intense-fg ansi-bold">(</span>x0<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> x<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    154</span>         z <span class="ansi-yellow-intense-fg ansi-bold">=</span> x0<span class="ansi-yellow-intense-fg ansi-bold">/</span>s
<span class="ansi-green-fg">    155</span>         Km1 <span class="ansi-yellow-intense-fg ansi-bold">=</span> x<span class="ansi-yellow-intense-fg ansi-bold">.</span>shape<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">-</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/var.py</span> in <span class="ansi-cyan-fg">__add__</span><span class="ansi-blue-intense-fg ansi-bold">(self, other)</span>
<span class="ansi-green-fg">    126</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> __add__<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> other<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    127</span>         <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 128</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> theano<span class="ansi-yellow-intense-fg ansi-bold">.</span>tensor<span class="ansi-yellow-intense-fg ansi-bold">.</span>basic<span class="ansi-yellow-intense-fg ansi-bold">.</span>add<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> other<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    129</span>         <span class="ansi-red-intense-fg ansi-bold"># We should catch the minimum number of exception here.</span>
<span class="ansi-green-fg">    130</span>         <span class="ansi-red-intense-fg ansi-bold"># Otherwise this will convert error when Theano flags</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self, *inputs, **kwargs)</span>
<span class="ansi-green-fg">    556</span>                 thunk<span class="ansi-yellow-intense-fg ansi-bold">.</span>outputs <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span>storage_map<span class="ansi-yellow-intense-fg ansi-bold">[</span>v<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> v <span class="ansi-green-intense-fg ansi-bold">in</span> node<span class="ansi-yellow-intense-fg ansi-bold">.</span>outputs<span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    557</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 558</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>required <span class="ansi-yellow-intense-fg ansi-bold">=</span> thunk<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    559</span>                 <span class="ansi-green-intense-fg ansi-bold">assert</span> <span class="ansi-green-intense-fg ansi-bold">not</span> required  <span class="ansi-red-intense-fg ansi-bold"># We provided all inputs</span>
<span class="ansi-green-fg">    560</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span> in <span class="ansi-cyan-fg">rval</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">    733</span>
<span class="ansi-green-fg">    734</span>         <span class="ansi-green-intense-fg ansi-bold">def</span> rval<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 735</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>fill_storage<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    736</span>             <span class="ansi-green-intense-fg ansi-bold">for</span> o <span class="ansi-green-intense-fg ansi-bold">in</span> node<span class="ansi-yellow-intense-fg ansi-bold">.</span>outputs<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    737</span>                 compute_map<span class="ansi-yellow-intense-fg ansi-bold">[</span>o<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> True

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/cc.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self)</span>
<span class="ansi-green-fg">   1538</span>                 <span class="ansi-green-intense-fg ansi-bold">raise</span>
<span class="ansi-green-fg">   1539</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1540</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">raise</span> exc_type<span class="ansi-yellow-intense-fg ansi-bold">,</span> exc_value<span class="ansi-yellow-intense-fg ansi-bold">,</span> exc_trace
<span class="ansi-green-fg">   1541</span>
<span class="ansi-green-fg">   1542</span>

<span class="ansi-red-intense-fg ansi-bold">ValueError</span>: Input dimension mis-match. (input[0].shape[0] = 6, input[1].shape[0] = 3)
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [32]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pymc3.distributions.transforms.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ImportError</span>                               Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-32-cfd1cc9f29ef&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span><span class="ansi-yellow-intense-fg ansi-bold"> </span><span class="ansi-green-intense-fg ansi-bold">import</span> pymc3<span class="ansi-yellow-intense-fg ansi-bold">.</span>transform

<span class="ansi-red-intense-fg ansi-bold">ImportError</span>: No module named transform
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="n">a1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[8]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Elemwise{mul,no_inplace}.0
</pre></div>
</div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pymc3</span> <span class="kn">import</span> <span class="n">Dirichlet</span><span class="p">,</span> <span class="n">Model</span>
<span class="k">with</span> <span class="n">Model</span><span class="p">():</span>
    <span class="n">Dirichlet</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-15-059ef57ab101&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">      1</span> <span class="ansi-green-intense-fg ansi-bold">from</span> pymc3 <span class="ansi-green-intense-fg ansi-bold">import</span> Dirichlet<span class="ansi-yellow-intense-fg ansi-bold">,</span> Model
<span class="ansi-green-fg">      2</span> <span class="ansi-green-intense-fg ansi-bold">with</span> Model<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 3</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>Dirichlet<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;beta&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> np<span class="ansi-yellow-intense-fg ansi-bold">.</span>ones<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">3</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">3</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">__new__</span><span class="ansi-blue-intense-fg ansi-bold">(cls, name, *args, **kwargs)</span>
<span class="ansi-green-fg">     17</span>             data <span class="ansi-yellow-intense-fg ansi-bold">=</span> kwargs<span class="ansi-yellow-intense-fg ansi-bold">.</span>pop<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;observed&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> None<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     18</span>             dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> cls<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 19</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> data<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     20</span>         <span class="ansi-green-intense-fg ansi-bold">elif</span> name <span class="ansi-green-intense-fg ansi-bold">is</span> None<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     21</span>             <span class="ansi-green-intense-fg ansi-bold">return</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-red-intense-fg ansi-bold">#for pickle</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">Var</span><span class="ansi-blue-intense-fg ansi-bold">(self, name, dist, data)</span>
<span class="ansi-green-fg">    151</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>free_RVs<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    152</span>             <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 153</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>var <span class="ansi-yellow-intense-fg ansi-bold">=</span> TransformedRV<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">=</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> model<span class="ansi-yellow-intense-fg ansi-bold">=</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>transform<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    154</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>deterministics<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    155</span>                 <span class="ansi-green-intense-fg ansi-bold">return</span> var

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, type, owner, index, name, distribution, model, transform)</span>
<span class="ansi-green-fg">    506</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>model <span class="ansi-yellow-intense-fg ansi-bold">=</span> model
<span class="ansi-green-fg">    507</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 508</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed <span class="ansi-yellow-intense-fg ansi-bold">=</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name <span class="ansi-yellow-intense-fg ansi-bold">+</span> <span class="ansi-blue-intense-fg ansi-bold">&#34;_&#34;</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>distribution<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    509</span>
<span class="ansi-green-fg">    510</span>             normalRV <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>backward<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">apply</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist)</span>
<span class="ansi-green-fg">     23</span>
<span class="ansi-green-fg">     24</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 25</span><span class="ansi-yellow-intense-fg ansi-bold">         </span><span class="ansi-green-intense-fg ansi-bold">return</span> TransformedDistribution<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     26</span>
<span class="ansi-green-fg">     27</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> __str__<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">dist</span><span class="ansi-blue-intense-fg ansi-bold">(cls, *args, **kwargs)</span>
<span class="ansi-green-fg">     29</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     30</span>         dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 31</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>__init__<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     32</span>         <span class="ansi-green-intense-fg ansi-bold">return</span> dist
<span class="ansi-green-fg">     33</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist, transform, *args, **kwargs)</span>
<span class="ansi-green-fg">     46</span>             arguments to Distribution&#34;&#34;&#34;
<span class="ansi-green-fg">     47</span>         forward <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>forward
<span class="ansi-green-intense-fg ansi-bold">---&gt; 48</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>testval <span class="ansi-yellow-intense-fg ansi-bold">=</span> forward<span class="ansi-yellow-intense-fg ansi-bold">(</span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>default<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     49</span>
<span class="ansi-green-fg">     50</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> dist

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-intense-fg ansi-bold">(self, x)</span>
<span class="ansi-green-fg">    151</span>         <span class="ansi-red-intense-fg ansi-bold">#reverse cumsum</span>
<span class="ansi-green-fg">    152</span>         x0 <span class="ansi-yellow-intense-fg ansi-bold">=</span> x<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 153</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>s <span class="ansi-yellow-intense-fg ansi-bold">=</span> t<span class="ansi-yellow-intense-fg ansi-bold">.</span>extra_ops<span class="ansi-yellow-intense-fg ansi-bold">.</span>cumsum<span class="ansi-yellow-intense-fg ansi-bold">(</span>x0<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> x<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    154</span>         z <span class="ansi-yellow-intense-fg ansi-bold">=</span> x0<span class="ansi-yellow-intense-fg ansi-bold">/</span>s
<span class="ansi-green-fg">    155</span>         Km1 <span class="ansi-yellow-intense-fg ansi-bold">=</span> x<span class="ansi-yellow-intense-fg ansi-bold">.</span>shape<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">-</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/var.py</span> in <span class="ansi-cyan-fg">__add__</span><span class="ansi-blue-intense-fg ansi-bold">(self, other)</span>
<span class="ansi-green-fg">    126</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> __add__<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> other<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    127</span>         <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 128</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> theano<span class="ansi-yellow-intense-fg ansi-bold">.</span>tensor<span class="ansi-yellow-intense-fg ansi-bold">.</span>basic<span class="ansi-yellow-intense-fg ansi-bold">.</span>add<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> other<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    129</span>         <span class="ansi-red-intense-fg ansi-bold"># We should catch the minimum number of exception here.</span>
<span class="ansi-green-fg">    130</span>         <span class="ansi-red-intense-fg ansi-bold"># Otherwise this will convert error when Theano flags</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self, *inputs, **kwargs)</span>
<span class="ansi-green-fg">    556</span>                 thunk<span class="ansi-yellow-intense-fg ansi-bold">.</span>outputs <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span>storage_map<span class="ansi-yellow-intense-fg ansi-bold">[</span>v<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> v <span class="ansi-green-intense-fg ansi-bold">in</span> node<span class="ansi-yellow-intense-fg ansi-bold">.</span>outputs<span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    557</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 558</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>required <span class="ansi-yellow-intense-fg ansi-bold">=</span> thunk<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    559</span>                 <span class="ansi-green-intense-fg ansi-bold">assert</span> <span class="ansi-green-intense-fg ansi-bold">not</span> required  <span class="ansi-red-intense-fg ansi-bold"># We provided all inputs</span>
<span class="ansi-green-fg">    560</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span> in <span class="ansi-cyan-fg">rval</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">    733</span>
<span class="ansi-green-fg">    734</span>         <span class="ansi-green-intense-fg ansi-bold">def</span> rval<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 735</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>fill_storage<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    736</span>             <span class="ansi-green-intense-fg ansi-bold">for</span> o <span class="ansi-green-intense-fg ansi-bold">in</span> node<span class="ansi-yellow-intense-fg ansi-bold">.</span>outputs<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    737</span>                 compute_map<span class="ansi-yellow-intense-fg ansi-bold">[</span>o<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> True

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/cc.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self)</span>
<span class="ansi-green-fg">   1538</span>                 <span class="ansi-green-intense-fg ansi-bold">raise</span>
<span class="ansi-green-fg">   1539</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1540</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">raise</span> exc_type<span class="ansi-yellow-intense-fg ansi-bold">,</span> exc_value<span class="ansi-yellow-intense-fg ansi-bold">,</span> exc_trace
<span class="ansi-green-fg">   1541</span>
<span class="ansi-green-fg">   1542</span>

<span class="ansi-red-intense-fg ansi-bold">ValueError</span>: Input dimension mis-match. (input[0].shape[0] = 6, input[1].shape[0] = 3)
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[2]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>array([[ 1.,  1.],
       [ 1.,  1.],
       [ 1.,  1.],
       [ 1.,  1.]])
</pre></div>
</div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">pdb</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
Automatic pdb calling has been turned ON
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[15]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>array([[ 1.,  1.],
       [ 1.,  1.],
       [ 1.,  1.],
       [ 1.,  1.]])
</pre></div>
</div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">Model</span><span class="p">():</span>
    <span class="n">Dirichlet</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-18-a22a8a1138c1&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">      1</span> <span class="ansi-green-intense-fg ansi-bold">with</span> Model<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 2</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>Dirichlet<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;beta&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> np<span class="ansi-yellow-intense-fg ansi-bold">.</span>ones<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">2</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">3</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">__new__</span><span class="ansi-blue-intense-fg ansi-bold">(cls, name, *args, **kwargs)</span>
<span class="ansi-green-fg">     17</span>             data <span class="ansi-yellow-intense-fg ansi-bold">=</span> kwargs<span class="ansi-yellow-intense-fg ansi-bold">.</span>pop<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;observed&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> None<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     18</span>             dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> cls<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 19</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> data<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     20</span>         <span class="ansi-green-intense-fg ansi-bold">elif</span> name <span class="ansi-green-intense-fg ansi-bold">is</span> None<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     21</span>             <span class="ansi-green-intense-fg ansi-bold">return</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-red-intense-fg ansi-bold">#for pickle</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">Var</span><span class="ansi-blue-intense-fg ansi-bold">(self, name, dist, data)</span>
<span class="ansi-green-fg">    151</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>free_RVs<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    152</span>             <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 153</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>var <span class="ansi-yellow-intense-fg ansi-bold">=</span> TransformedRV<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">=</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> model<span class="ansi-yellow-intense-fg ansi-bold">=</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>transform<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    154</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>deterministics<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    155</span>                 <span class="ansi-green-intense-fg ansi-bold">return</span> var

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, type, owner, index, name, distribution, model, transform)</span>
<span class="ansi-green-fg">    506</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>model <span class="ansi-yellow-intense-fg ansi-bold">=</span> model
<span class="ansi-green-fg">    507</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 508</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed <span class="ansi-yellow-intense-fg ansi-bold">=</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name <span class="ansi-yellow-intense-fg ansi-bold">+</span> <span class="ansi-blue-intense-fg ansi-bold">&#34;_&#34;</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>distribution<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    509</span>
<span class="ansi-green-fg">    510</span>             normalRV <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>backward<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">apply</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist)</span>
<span class="ansi-green-fg">     23</span>
<span class="ansi-green-fg">     24</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 25</span><span class="ansi-yellow-intense-fg ansi-bold">         </span><span class="ansi-green-intense-fg ansi-bold">return</span> TransformedDistribution<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     26</span>
<span class="ansi-green-fg">     27</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> __str__<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">dist</span><span class="ansi-blue-intense-fg ansi-bold">(cls, *args, **kwargs)</span>
<span class="ansi-green-fg">     29</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     30</span>         dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 31</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>__init__<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     32</span>         <span class="ansi-green-intense-fg ansi-bold">return</span> dist
<span class="ansi-green-fg">     33</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist, transform, *args, **kwargs)</span>
<span class="ansi-green-fg">     50</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> dist
<span class="ansi-green-fg">     51</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transform_used <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform
<span class="ansi-green-intense-fg ansi-bold">---&gt; 52</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>v <span class="ansi-yellow-intense-fg ansi-bold">=</span> forward<span class="ansi-yellow-intense-fg ansi-bold">(</span>FreeRV<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;v&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     53</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>type <span class="ansi-yellow-intense-fg ansi-bold">=</span> v<span class="ansi-yellow-intense-fg ansi-bold">.</span>type
<span class="ansi-green-fg">     54</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, type, owner, index, name, distribution, model)</span>
<span class="ansi-green-fg">    360</span>             self.tag.test_value = np.ones(
<span class="ansi-green-fg">    361</span>                 distribution.shape, distribution.dtype) * distribution.default()
<span class="ansi-green-intense-fg ansi-bold">--&gt; 362</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>logp_elemwiset <span class="ansi-yellow-intense-fg ansi-bold">=</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">.</span>logp<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    363</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>model <span class="ansi-yellow-intense-fg ansi-bold">=</span> model
<span class="ansi-green-fg">    364</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/multivariate.py</span> in <span class="ansi-cyan-fg">logp</span><span class="ansi-blue-intense-fg ansi-bold">(self, value)</span>
<span class="ansi-green-fg">     83</span>         <span class="ansi-red-intense-fg ansi-bold"># only defined for sum(value) == 1</span>
<span class="ansi-green-fg">     84</span>         return bound(
<span class="ansi-green-intense-fg ansi-bold">---&gt; 85</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>sum<span class="ansi-yellow-intense-fg ansi-bold">(</span>logpow<span class="ansi-yellow-intense-fg ansi-bold">(</span>value<span class="ansi-yellow-intense-fg ansi-bold">,</span> a <span class="ansi-yellow-intense-fg ansi-bold">-</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">-</span> gammaln<span class="ansi-yellow-intense-fg ansi-bold">(</span>a<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> axis<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> gammaln<span class="ansi-yellow-intense-fg ansi-bold">(</span>sum<span class="ansi-yellow-intense-fg ansi-bold">(</span>a<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">     86</span>             k <span class="ansi-yellow-intense-fg ansi-bold">&gt;</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">     87</span>             all<span class="ansi-yellow-intense-fg ansi-bold">(</span>a <span class="ansi-yellow-intense-fg ansi-bold">&gt;</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/dist_math.py</span> in <span class="ansi-cyan-fg">logpow</span><span class="ansi-blue-intense-fg ansi-bold">(x, m)</span>
<span class="ansi-green-fg">     54</span>     Calculates log<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">**</span>m<span class="ansi-yellow-intense-fg ansi-bold">)</span> since m<span class="ansi-yellow-intense-fg ansi-bold">*</span>log<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span> will fail when m<span class="ansi-yellow-intense-fg ansi-bold">,</span> x <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-cyan-intense-fg ansi-bold">0.</span>
<span class="ansi-green-fg">     55</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">---&gt; 56</span><span class="ansi-yellow-intense-fg ansi-bold">     </span><span class="ansi-green-intense-fg ansi-bold">return</span> switch<span class="ansi-yellow-intense-fg ansi-bold">(</span>eq<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">&amp;</span> eq<span class="ansi-yellow-intense-fg ansi-bold">(</span>m<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> m <span class="ansi-yellow-intense-fg ansi-bold">*</span> log<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     57</span>
<span class="ansi-green-fg">     58</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self, *inputs, **kwargs)</span>
<span class="ansi-green-fg">    515</span>             <span class="ansi-green-intense-fg ansi-bold">for</span> i<span class="ansi-yellow-intense-fg ansi-bold">,</span> ins <span class="ansi-green-intense-fg ansi-bold">in</span> enumerate<span class="ansi-yellow-intense-fg ansi-bold">(</span>node<span class="ansi-yellow-intense-fg ansi-bold">.</span>inputs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    516</span>                 <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 517</span><span class="ansi-yellow-intense-fg ansi-bold">                     </span>storage_map<span class="ansi-yellow-intense-fg ansi-bold">[</span>ins<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_get_test_value<span class="ansi-yellow-intense-fg ansi-bold">(</span>ins<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    518</span>                     compute_map<span class="ansi-yellow-intense-fg ansi-bold">[</span>ins<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span>True<span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    519</span>                 <span class="ansi-green-intense-fg ansi-bold">except</span> AttributeError<span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span> in <span class="ansi-cyan-fg">_get_test_value</span><span class="ansi-blue-intense-fg ansi-bold">(cls, v)</span>
<span class="ansi-green-fg">    452</span>             <span class="ansi-red-intense-fg ansi-bold"># ensure that the test value is correct</span>
<span class="ansi-green-fg">    453</span>             <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 454</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>ret <span class="ansi-yellow-intense-fg ansi-bold">=</span> v<span class="ansi-yellow-intense-fg ansi-bold">.</span>type<span class="ansi-yellow-intense-fg ansi-bold">.</span>filter<span class="ansi-yellow-intense-fg ansi-bold">(</span>v<span class="ansi-yellow-intense-fg ansi-bold">.</span>tag<span class="ansi-yellow-intense-fg ansi-bold">.</span>test_value<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    455</span>             <span class="ansi-green-intense-fg ansi-bold">except</span> Exception <span class="ansi-green-intense-fg ansi-bold">as</span> e<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    456</span>                 <span class="ansi-red-intense-fg ansi-bold"># Better error message.</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/type.py</span> in <span class="ansi-cyan-fg">filter</span><span class="ansi-blue-intense-fg ansi-bold">(self, data, strict, allow_downcast)</span>
<span class="ansi-green-fg">    166</span>             raise TypeError(&#34;Wrong number of dimensions: expected %s,&#34;
<span class="ansi-green-fg">    167</span>                             &#34; got %s with shape %s.&#34; % (self.ndim, data.ndim,
<span class="ansi-green-intense-fg ansi-bold">--&gt; 168</span><span class="ansi-yellow-intense-fg ansi-bold">                                                         data.shape))
</span><span class="ansi-green-fg">    169</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-green-intense-fg ansi-bold">not</span> data<span class="ansi-yellow-intense-fg ansi-bold">.</span>flags<span class="ansi-yellow-intense-fg ansi-bold">.</span>aligned<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    170</span>             <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-red-intense-fg ansi-bold">TypeError</span>: For compute_test_value, one input test value does not have the requested type.

The error when converting the test value to that variable type:
Wrong number of dimensions: expected 0, got 2 with shape (2, 3).
</pre></div></div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
&gt; <span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/type.py</span>(168)<span class="ansi-cyan-fg">filter</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">    167 </span><span class="ansi-yellow-intense-fg ansi-bold">                            &#34; got %s with shape %s.&#34; % (self.ndim, data.ndim,
</span><span class="ansi-green-intense-fg ansi-bold">--&gt; 168 </span><span class="ansi-yellow-intense-fg ansi-bold">                                                        data.shape))
</span><span class="ansi-green-intense-fg ansi-bold">    169 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span><span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-green-intense-fg ansi-bold">not</span> data<span class="ansi-yellow-intense-fg ansi-bold">.</span>flags<span class="ansi-yellow-intense-fg ansi-bold">.</span>aligned<span class="ansi-yellow-intense-fg ansi-bold">:</span>

ipdb&gt; c
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">pdb</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
Automatic pdb calling has been turned ON
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="c1">## Data Preparation</span>

<span class="n">K</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># number of topics</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># number of words</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># number of documents</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">Wd</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>  <span class="c1"># length of each document</span>

<span class="c1">## Model Specification</span>

<span class="kn">from</span> <span class="nn">pymc3</span> <span class="kn">import</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Normal</span><span class="p">,</span> <span class="n">HalfNormal</span><span class="p">,</span> <span class="n">Dirichlet</span><span class="p">,</span> <span class="n">Categorical</span><span class="p">,</span> <span class="n">constant</span>
<span class="kn">from</span> <span class="nn">pymc3.distributions.transforms</span> <span class="kn">import</span> <span class="n">sum_to_1</span>

<span class="n">lda_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>

<span class="k">with</span> <span class="n">lda_model</span><span class="p">:</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">Dirichlet</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">))</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">Dirichlet</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">K</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;z_</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">d</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">d</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="n">Wd</span><span class="p">[</span><span class="n">d</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">D</span><span class="p">)]</span>

    <span class="c1"># That&#39;s when you get the error. It is caused by: beta[z[d][w]]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;w_</span><span class="si">%i</span><span class="s1">_</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">beta</span><span class="p">[</span><span class="n">z</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="n">w</span><span class="p">]],</span> <span class="n">observed</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">D</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Wd</span><span class="p">[</span><span class="n">d</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">AsTensorError</span>                             Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-5-114403a3356a&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">     18</span>
<span class="ansi-green-fg">     19</span> <span class="ansi-green-intense-fg ansi-bold">with</span> lda_model<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 20</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>beta <span class="ansi-yellow-intense-fg ansi-bold">=</span> Dirichlet<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;beta&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> np<span class="ansi-yellow-intense-fg ansi-bold">.</span>ones<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">(</span>N<span class="ansi-yellow-intense-fg ansi-bold">,</span> K<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> shape<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-yellow-intense-fg ansi-bold">(</span>N<span class="ansi-yellow-intense-fg ansi-bold">,</span> K<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     21</span>     theta <span class="ansi-yellow-intense-fg ansi-bold">=</span> Dirichlet<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;theta&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> np<span class="ansi-yellow-intense-fg ansi-bold">.</span>ones<span class="ansi-yellow-intense-fg ansi-bold">(</span>K<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> shape<span class="ansi-yellow-intense-fg ansi-bold">=</span>D<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     22</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">__new__</span><span class="ansi-blue-intense-fg ansi-bold">(cls, name, *args, **kwargs)</span>
<span class="ansi-green-fg">     17</span>             data <span class="ansi-yellow-intense-fg ansi-bold">=</span> kwargs<span class="ansi-yellow-intense-fg ansi-bold">.</span>pop<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;observed&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> None<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     18</span>             dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> cls<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 19</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> data<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     20</span>         <span class="ansi-green-intense-fg ansi-bold">elif</span> name <span class="ansi-green-intense-fg ansi-bold">is</span> None<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     21</span>             <span class="ansi-green-intense-fg ansi-bold">return</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-red-intense-fg ansi-bold">#for pickle</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">Var</span><span class="ansi-blue-intense-fg ansi-bold">(self, name, dist, data)</span>
<span class="ansi-green-fg">    151</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>free_RVs<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    152</span>             <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 153</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>var <span class="ansi-yellow-intense-fg ansi-bold">=</span> TransformedRV<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">=</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> model<span class="ansi-yellow-intense-fg ansi-bold">=</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>transform<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    154</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>deterministics<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    155</span>                 <span class="ansi-green-intense-fg ansi-bold">return</span> var

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, type, owner, index, name, distribution, model, transform)</span>
<span class="ansi-green-fg">    506</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>model <span class="ansi-yellow-intense-fg ansi-bold">=</span> model
<span class="ansi-green-fg">    507</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 508</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed <span class="ansi-yellow-intense-fg ansi-bold">=</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name <span class="ansi-yellow-intense-fg ansi-bold">+</span> <span class="ansi-blue-intense-fg ansi-bold">&#34;_&#34;</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>distribution<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    509</span>
<span class="ansi-green-fg">    510</span>             normalRV <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>backward<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">apply</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist)</span>
<span class="ansi-green-fg">     23</span>
<span class="ansi-green-fg">     24</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 25</span><span class="ansi-yellow-intense-fg ansi-bold">         </span><span class="ansi-green-intense-fg ansi-bold">return</span> TransformedDistribution<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     26</span>
<span class="ansi-green-fg">     27</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> __str__<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">dist</span><span class="ansi-blue-intense-fg ansi-bold">(cls, *args, **kwargs)</span>
<span class="ansi-green-fg">     29</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     30</span>         dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 31</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>__init__<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     32</span>         <span class="ansi-green-intense-fg ansi-bold">return</span> dist
<span class="ansi-green-fg">     33</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist, transform, *args, **kwargs)</span>
<span class="ansi-green-fg">     50</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> dist
<span class="ansi-green-fg">     51</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transform_used <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform
<span class="ansi-green-intense-fg ansi-bold">---&gt; 52</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>v <span class="ansi-yellow-intense-fg ansi-bold">=</span> forward<span class="ansi-yellow-intense-fg ansi-bold">(</span>FreeRV<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;v&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     53</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>type <span class="ansi-yellow-intense-fg ansi-bold">=</span> v<span class="ansi-yellow-intense-fg ansi-bold">.</span>type
<span class="ansi-green-fg">     54</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-intense-fg ansi-bold">(self, x)</span>
<span class="ansi-green-fg">    150</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> forward<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> x<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    151</span>         <span class="ansi-red-intense-fg ansi-bold">#reverse cumsum</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 152</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>x0 <span class="ansi-yellow-intense-fg ansi-bold">=</span> x<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    153</span>         s <span class="ansi-yellow-intense-fg ansi-bold">=</span> t<span class="ansi-yellow-intense-fg ansi-bold">.</span>extra_ops<span class="ansi-yellow-intense-fg ansi-bold">.</span>cumsum<span class="ansi-yellow-intense-fg ansi-bold">(</span>x0<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> axis<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> x<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">,</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    154</span>         z <span class="ansi-yellow-intense-fg ansi-bold">=</span> x0<span class="ansi-yellow-intense-fg ansi-bold">/</span>s

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/var.py</span> in <span class="ansi-cyan-fg">__getitem__</span><span class="ansi-blue-intense-fg ansi-bold">(self, args)</span>
<span class="ansi-green-fg">    392</span>                 <span class="ansi-green-intense-fg ansi-bold">return</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>take<span class="ansi-yellow-intense-fg ansi-bold">(</span>args<span class="ansi-yellow-intense-fg ansi-bold">[</span>axis<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> axis<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    393</span>             <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 394</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span><span class="ansi-green-intense-fg ansi-bold">return</span> theano<span class="ansi-yellow-intense-fg ansi-bold">.</span>tensor<span class="ansi-yellow-intense-fg ansi-bold">.</span>subtensor<span class="ansi-yellow-intense-fg ansi-bold">.</span>advanced_subtensor<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    395</span>         <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    396</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> numpy<span class="ansi-yellow-intense-fg ansi-bold">.</span>newaxis <span class="ansi-green-intense-fg ansi-bold">in</span> args<span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self, *inputs, **kwargs)</span>
<span class="ansi-green-fg">    505</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">    506</span>         return_list <span class="ansi-yellow-intense-fg ansi-bold">=</span> kwargs<span class="ansi-yellow-intense-fg ansi-bold">.</span>pop<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;return_list&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> False<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 507</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>node <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>make_node<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>inputs<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    508</span>
<span class="ansi-green-fg">    509</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> config<span class="ansi-yellow-intense-fg ansi-bold">.</span>compute_test_value <span class="ansi-yellow-intense-fg ansi-bold">!=</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;off&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/subtensor.py</span> in <span class="ansi-cyan-fg">make_node</span><span class="ansi-blue-intense-fg ansi-bold">(self, x, *index)</span>
<span class="ansi-green-fg">   2048</span>         x <span class="ansi-yellow-intense-fg ansi-bold">=</span> theano<span class="ansi-yellow-intense-fg ansi-bold">.</span>tensor<span class="ansi-yellow-intense-fg ansi-bold">.</span>as_tensor_variable<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2049</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2050</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>index <span class="ansi-yellow-intense-fg ansi-bold">=</span> tuple<span class="ansi-yellow-intense-fg ansi-bold">(</span>map<span class="ansi-yellow-intense-fg ansi-bold">(</span>as_index_variable<span class="ansi-yellow-intense-fg ansi-bold">,</span> index<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2051</span>         bcast <span class="ansi-yellow-intense-fg ansi-bold">=</span> adv_index_broadcastable_pattern<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">,</span> index<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2052</span>         return gof.Apply(self,

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/subtensor.py</span> in <span class="ansi-cyan-fg">as_index_variable</span><span class="ansi-blue-intense-fg ansi-bold">(idx)</span>
<span class="ansi-green-fg">   1990</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> isinstance<span class="ansi-yellow-intense-fg ansi-bold">(</span>idx<span class="ansi-yellow-intense-fg ansi-bold">,</span> gof<span class="ansi-yellow-intense-fg ansi-bold">.</span>Variable<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">and</span> isinstance<span class="ansi-yellow-intense-fg ansi-bold">(</span>idx<span class="ansi-yellow-intense-fg ansi-bold">.</span>type<span class="ansi-yellow-intense-fg ansi-bold">,</span> SliceType<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1991</span>         <span class="ansi-green-intense-fg ansi-bold">return</span> idx
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1992</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>idx <span class="ansi-yellow-intense-fg ansi-bold">=</span> theano<span class="ansi-yellow-intense-fg ansi-bold">.</span>tensor<span class="ansi-yellow-intense-fg ansi-bold">.</span>as_tensor_variable<span class="ansi-yellow-intense-fg ansi-bold">(</span>idx<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   1993</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> idx<span class="ansi-yellow-intense-fg ansi-bold">.</span>type<span class="ansi-yellow-intense-fg ansi-bold">.</span>dtype<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-cyan-intense-fg ansi-bold">3</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">in</span> <span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;int&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;uin&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1994</span>         <span class="ansi-green-intense-fg ansi-bold">raise</span> TypeError<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;index must be integers&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/basic.py</span> in <span class="ansi-cyan-fg">as_tensor_variable</span><span class="ansi-blue-intense-fg ansi-bold">(x, name, ndim)</span>
<span class="ansi-green-fg">    200</span>         <span class="ansi-green-intense-fg ansi-bold">except</span> Exception<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    201</span>             str_x <span class="ansi-yellow-intense-fg ansi-bold">=</span> repr<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 202</span><span class="ansi-yellow-intense-fg ansi-bold">         </span><span class="ansi-green-intense-fg ansi-bold">raise</span> AsTensorError<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#34;Cannot convert %s to TensorType&#34;</span> <span class="ansi-yellow-intense-fg ansi-bold">%</span> str_x<span class="ansi-yellow-intense-fg ansi-bold">,</span> type<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    203</span>
<span class="ansi-green-fg">    204</span> <span class="ansi-red-intense-fg ansi-bold"># this has a different name, because _as_tensor_variable is the</span>

<span class="ansi-red-intense-fg ansi-bold">AsTensorError</span>: (&#39;Cannot convert Ellipsis to TensorType&#39;, &lt;type &#39;ellipsis&#39;&gt;)
</pre></div></div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
&gt; <span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/basic.py</span>(202)<span class="ansi-cyan-fg">as_tensor_variable</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">    201 </span><span class="ansi-yellow-intense-fg ansi-bold">            </span>str_x <span class="ansi-yellow-intense-fg ansi-bold">=</span> repr<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 202 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span><span class="ansi-green-intense-fg ansi-bold">raise</span> AsTensorError<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#34;Cannot convert %s to TensorType&#34;</span> <span class="ansi-yellow-intense-fg ansi-bold">%</span> str_x<span class="ansi-yellow-intense-fg ansi-bold">,</span> type<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">    203 </span>

ipdb&gt; up
&gt; <span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/subtensor.py</span>(1992)<span class="ansi-cyan-fg">as_index_variable</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">   1991 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span><span class="ansi-green-intense-fg ansi-bold">return</span> idx
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1992 </span><span class="ansi-yellow-intense-fg ansi-bold">    </span>idx <span class="ansi-yellow-intense-fg ansi-bold">=</span> theano<span class="ansi-yellow-intense-fg ansi-bold">.</span>tensor<span class="ansi-yellow-intense-fg ansi-bold">.</span>as_tensor_variable<span class="ansi-yellow-intense-fg ansi-bold">(</span>idx<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1993 </span><span class="ansi-yellow-intense-fg ansi-bold">    </span><span class="ansi-green-intense-fg ansi-bold">if</span> idx<span class="ansi-yellow-intense-fg ansi-bold">.</span>type<span class="ansi-yellow-intense-fg ansi-bold">.</span>dtype<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-cyan-intense-fg ansi-bold">3</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">in</span> <span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;int&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;uin&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

ipdb&gt;
&gt; <span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/subtensor.py</span>(2050)<span class="ansi-cyan-fg">make_node</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">   2049 </span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2050 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span>index <span class="ansi-yellow-intense-fg ansi-bold">=</span> tuple<span class="ansi-yellow-intense-fg ansi-bold">(</span>map<span class="ansi-yellow-intense-fg ansi-bold">(</span>as_index_variable<span class="ansi-yellow-intense-fg ansi-bold">,</span> index<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2051 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span>bcast <span class="ansi-yellow-intense-fg ansi-bold">=</span> adv_index_broadcastable_pattern<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">,</span> index<span class="ansi-yellow-intense-fg ansi-bold">)</span>

ipdb&gt;
&gt; <span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span>(507)<span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">    506 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span>return_list <span class="ansi-yellow-intense-fg ansi-bold">=</span> kwargs<span class="ansi-yellow-intense-fg ansi-bold">.</span>pop<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;return_list&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> False<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 507 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span>node <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>make_node<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>inputs<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">    508 </span>

ipdb&gt;
&gt; <span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/var.py</span>(394)<span class="ansi-cyan-fg">__getitem__</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">    393 </span><span class="ansi-yellow-intense-fg ansi-bold">            </span><span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 394 </span><span class="ansi-yellow-intense-fg ansi-bold">                </span><span class="ansi-green-intense-fg ansi-bold">return</span> theano<span class="ansi-yellow-intense-fg ansi-bold">.</span>tensor<span class="ansi-yellow-intense-fg ansi-bold">.</span>subtensor<span class="ansi-yellow-intense-fg ansi-bold">.</span>advanced_subtensor<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">    395 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span><span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

ipdb&gt;
&gt; <span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(152)<span class="ansi-cyan-fg">forward</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">    151 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span><span class="ansi-red-intense-fg ansi-bold">#reverse cumsum</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 152 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span>x0 <span class="ansi-yellow-intense-fg ansi-bold">=</span> x<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-intense-fg ansi-bold">    153 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span>s <span class="ansi-yellow-intense-fg ansi-bold">=</span> t<span class="ansi-yellow-intense-fg ansi-bold">.</span>extra_ops<span class="ansi-yellow-intense-fg ansi-bold">.</span>cumsum<span class="ansi-yellow-intense-fg ansi-bold">(</span>x0<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> axis<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> x<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">.</span><span class="ansi-yellow-intense-fg ansi-bold">,</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>

ipdb&gt; x
v
ipdb&gt; type(x0
*** SyntaxError: unexpected EOF while parsing (&lt;stdin&gt;, line 1)
ipdb&gt; type(x)
&lt;class &#39;pymc3.model.FreeRV&#39;&gt;
ipdb&gt; c
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="n">a</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[4]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>TensorConstant{[ 2.  3.  ...  2.  2.]}
</pre></div>
</div>
</div>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<span class="k">with</span> <span class="n">model</span><span class="p">:</span>

    <span class="n">k</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">constant</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">Dirichlet</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">pdb</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
Automatic pdb calling has been turned ON
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pymc3</span> <span class="kn">import</span> <span class="n">Dirichlet</span><span class="p">,</span> <span class="n">Model</span>
<span class="k">with</span> <span class="n">Model</span><span class="p">():</span>
    <span class="n">Dirichlet</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
Couldn&#39;t import dot_parser, loading of dot files will not be possible.
</pre></div></div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="stderr container">
<div class="highlight"><pre>
Using gpu device 0: NVS 5200M
</pre></div></div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-2-50a504bad0f8&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">      2</span> <span class="ansi-green-intense-fg ansi-bold">from</span> pymc3 <span class="ansi-green-intense-fg ansi-bold">import</span> Dirichlet<span class="ansi-yellow-intense-fg ansi-bold">,</span> Model
<span class="ansi-green-fg">      3</span> <span class="ansi-green-intense-fg ansi-bold">with</span> Model<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 4</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>Dirichlet<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;beta&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> np<span class="ansi-yellow-intense-fg ansi-bold">.</span>ones<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">4</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">3</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">__new__</span><span class="ansi-blue-intense-fg ansi-bold">(cls, name, *args, **kwargs)</span>
<span class="ansi-green-fg">     17</span>             data <span class="ansi-yellow-intense-fg ansi-bold">=</span> kwargs<span class="ansi-yellow-intense-fg ansi-bold">.</span>pop<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;observed&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> None<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     18</span>             dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> cls<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 19</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> data<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     20</span>         <span class="ansi-green-intense-fg ansi-bold">elif</span> name <span class="ansi-green-intense-fg ansi-bold">is</span> None<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     21</span>             <span class="ansi-green-intense-fg ansi-bold">return</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-red-intense-fg ansi-bold">#for pickle</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">Var</span><span class="ansi-blue-intense-fg ansi-bold">(self, name, dist, data)</span>
<span class="ansi-green-fg">    151</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>free_RVs<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    152</span>             <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 153</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>var <span class="ansi-yellow-intense-fg ansi-bold">=</span> TransformedRV<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">=</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> model<span class="ansi-yellow-intense-fg ansi-bold">=</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>transform<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    154</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>deterministics<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    155</span>                 <span class="ansi-green-intense-fg ansi-bold">return</span> var

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, type, owner, index, name, distribution, model, transform)</span>
<span class="ansi-green-fg">    506</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>model <span class="ansi-yellow-intense-fg ansi-bold">=</span> model
<span class="ansi-green-fg">    507</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 508</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed <span class="ansi-yellow-intense-fg ansi-bold">=</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name <span class="ansi-yellow-intense-fg ansi-bold">+</span> <span class="ansi-blue-intense-fg ansi-bold">&#34;_&#34;</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>distribution<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    509</span>
<span class="ansi-green-fg">    510</span>             normalRV <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>backward<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">apply</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist)</span>
<span class="ansi-green-fg">     23</span>
<span class="ansi-green-fg">     24</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 25</span><span class="ansi-yellow-intense-fg ansi-bold">         </span><span class="ansi-green-intense-fg ansi-bold">return</span> TransformedDistribution<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     26</span>
<span class="ansi-green-fg">     27</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> __str__<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">dist</span><span class="ansi-blue-intense-fg ansi-bold">(cls, *args, **kwargs)</span>
<span class="ansi-green-fg">     29</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     30</span>         dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 31</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>__init__<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     32</span>         <span class="ansi-green-intense-fg ansi-bold">return</span> dist
<span class="ansi-green-fg">     33</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist, transform, *args, **kwargs)</span>
<span class="ansi-green-fg">     50</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> dist
<span class="ansi-green-fg">     51</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transform_used <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform
<span class="ansi-green-intense-fg ansi-bold">---&gt; 52</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>v <span class="ansi-yellow-intense-fg ansi-bold">=</span> forward<span class="ansi-yellow-intense-fg ansi-bold">(</span>FreeRV<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;v&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     53</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>type <span class="ansi-yellow-intense-fg ansi-bold">=</span> v<span class="ansi-yellow-intense-fg ansi-bold">.</span>type
<span class="ansi-green-fg">     54</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, type, owner, index, name, distribution, model)</span>
<span class="ansi-green-fg">    360</span>             self.tag.test_value = np.ones(
<span class="ansi-green-fg">    361</span>                 distribution.shape, distribution.dtype) * distribution.default()
<span class="ansi-green-intense-fg ansi-bold">--&gt; 362</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>logp_elemwiset <span class="ansi-yellow-intense-fg ansi-bold">=</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">.</span>logp<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    363</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>model <span class="ansi-yellow-intense-fg ansi-bold">=</span> model
<span class="ansi-green-fg">    364</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/multivariate.py</span> in <span class="ansi-cyan-fg">logp</span><span class="ansi-blue-intense-fg ansi-bold">(self, value)</span>
<span class="ansi-green-fg">     83</span>         <span class="ansi-red-intense-fg ansi-bold"># only defined for sum(value) == 1</span>
<span class="ansi-green-fg">     84</span>         return bound(
<span class="ansi-green-intense-fg ansi-bold">---&gt; 85</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>sum<span class="ansi-yellow-intense-fg ansi-bold">(</span>logpow<span class="ansi-yellow-intense-fg ansi-bold">(</span>value<span class="ansi-yellow-intense-fg ansi-bold">,</span> a <span class="ansi-yellow-intense-fg ansi-bold">-</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">-</span> gammaln<span class="ansi-yellow-intense-fg ansi-bold">(</span>a<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> axis<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> gammaln<span class="ansi-yellow-intense-fg ansi-bold">(</span>sum<span class="ansi-yellow-intense-fg ansi-bold">(</span>a<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">     86</span>             k <span class="ansi-yellow-intense-fg ansi-bold">&gt;</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">     87</span>             all<span class="ansi-yellow-intense-fg ansi-bold">(</span>a <span class="ansi-yellow-intense-fg ansi-bold">&gt;</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/dist_math.py</span> in <span class="ansi-cyan-fg">logpow</span><span class="ansi-blue-intense-fg ansi-bold">(x, m)</span>
<span class="ansi-green-fg">     54</span>     Calculates log<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">**</span>m<span class="ansi-yellow-intense-fg ansi-bold">)</span> since m<span class="ansi-yellow-intense-fg ansi-bold">*</span>log<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span> will fail when m<span class="ansi-yellow-intense-fg ansi-bold">,</span> x <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-cyan-intense-fg ansi-bold">0.</span>
<span class="ansi-green-fg">     55</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">---&gt; 56</span><span class="ansi-yellow-intense-fg ansi-bold">     </span><span class="ansi-green-intense-fg ansi-bold">return</span> switch<span class="ansi-yellow-intense-fg ansi-bold">(</span>eq<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">&amp;</span> eq<span class="ansi-yellow-intense-fg ansi-bold">(</span>m<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> m <span class="ansi-yellow-intense-fg ansi-bold">*</span> log<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     57</span>
<span class="ansi-green-fg">     58</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self, *inputs, **kwargs)</span>
<span class="ansi-green-fg">    515</span>             <span class="ansi-green-intense-fg ansi-bold">for</span> i<span class="ansi-yellow-intense-fg ansi-bold">,</span> ins <span class="ansi-green-intense-fg ansi-bold">in</span> enumerate<span class="ansi-yellow-intense-fg ansi-bold">(</span>node<span class="ansi-yellow-intense-fg ansi-bold">.</span>inputs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    516</span>                 <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 517</span><span class="ansi-yellow-intense-fg ansi-bold">                     </span>storage_map<span class="ansi-yellow-intense-fg ansi-bold">[</span>ins<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_get_test_value<span class="ansi-yellow-intense-fg ansi-bold">(</span>ins<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    518</span>                     compute_map<span class="ansi-yellow-intense-fg ansi-bold">[</span>ins<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span>True<span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    519</span>                 <span class="ansi-green-intense-fg ansi-bold">except</span> AttributeError<span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span> in <span class="ansi-cyan-fg">_get_test_value</span><span class="ansi-blue-intense-fg ansi-bold">(cls, v)</span>
<span class="ansi-green-fg">    452</span>             <span class="ansi-red-intense-fg ansi-bold"># ensure that the test value is correct</span>
<span class="ansi-green-fg">    453</span>             <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 454</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>ret <span class="ansi-yellow-intense-fg ansi-bold">=</span> v<span class="ansi-yellow-intense-fg ansi-bold">.</span>type<span class="ansi-yellow-intense-fg ansi-bold">.</span>filter<span class="ansi-yellow-intense-fg ansi-bold">(</span>v<span class="ansi-yellow-intense-fg ansi-bold">.</span>tag<span class="ansi-yellow-intense-fg ansi-bold">.</span>test_value<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    455</span>             <span class="ansi-green-intense-fg ansi-bold">except</span> Exception <span class="ansi-green-intense-fg ansi-bold">as</span> e<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    456</span>                 <span class="ansi-red-intense-fg ansi-bold"># Better error message.</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/type.py</span> in <span class="ansi-cyan-fg">filter</span><span class="ansi-blue-intense-fg ansi-bold">(self, data, strict, allow_downcast)</span>
<span class="ansi-green-fg">    166</span>             raise TypeError(&#34;Wrong number of dimensions: expected %s,&#34;
<span class="ansi-green-fg">    167</span>                             &#34; got %s with shape %s.&#34; % (self.ndim, data.ndim,
<span class="ansi-green-intense-fg ansi-bold">--&gt; 168</span><span class="ansi-yellow-intense-fg ansi-bold">                                                         data.shape))
</span><span class="ansi-green-fg">    169</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-green-intense-fg ansi-bold">not</span> data<span class="ansi-yellow-intense-fg ansi-bold">.</span>flags<span class="ansi-yellow-intense-fg ansi-bold">.</span>aligned<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    170</span>             <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-red-intense-fg ansi-bold">TypeError</span>: For compute_test_value, one input test value does not have the requested type.

The error when converting the test value to that variable type:
Wrong number of dimensions: expected 0, got 2 with shape (4, 3).
</pre></div></div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
&gt; <span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/type.py</span>(168)<span class="ansi-cyan-fg">filter</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">    167 </span><span class="ansi-yellow-intense-fg ansi-bold">                            &#34; got %s with shape %s.&#34; % (self.ndim, data.ndim,
</span><span class="ansi-green-intense-fg ansi-bold">--&gt; 168 </span><span class="ansi-yellow-intense-fg ansi-bold">                                                        data.shape))
</span><span class="ansi-green-intense-fg ansi-bold">    169 </span><span class="ansi-yellow-intense-fg ansi-bold">        </span><span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-green-intense-fg ansi-bold">not</span> data<span class="ansi-yellow-intense-fg ansi-bold">.</span>flags<span class="ansi-yellow-intense-fg ansi-bold">.</span>aligned<span class="ansi-yellow-intense-fg ansi-bold">:</span>

ipdb&gt; self.ndim
0
ipdb&gt; data.ndim
2
ipdb&gt; c
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[4]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>array([ 1.,  1.])
</pre></div>
</div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pymc3</span> <span class="kn">import</span> <span class="n">Dirichlet</span><span class="p">,</span> <span class="n">Model</span>
<span class="k">with</span> <span class="n">Model</span><span class="p">():</span>
    <span class="n">Dirichlet</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
&gt; <span class="ansi-yellow-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(<span class="ansi-cyan-intense-fg ansi-bold">153</span>)forward()
-&gt; x0 = x[..., :-1]
(Pdb++) n
&gt; <span class="ansi-yellow-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(<span class="ansi-cyan-intense-fg ansi-bold">154</span>)forward()
-&gt; s = t.extra_ops.cumsum(x0[::-1], axis=-1)[::-1] + x[...,-1]
(Pdb++) x0
array([[ 0.16666667,  0.16666667],
       [ 0.16666667,  0.16666667]])
(Pdb++) n
&gt; <span class="ansi-yellow-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(<span class="ansi-cyan-intense-fg ansi-bold">155</span>)forward()
-&gt; z = x0/s
(Pdb++) n
&gt; <span class="ansi-yellow-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(<span class="ansi-cyan-intense-fg ansi-bold">156</span>)forward()
-&gt; Km1 = x.shape[-1] - 1
(Pdb++)
&gt; <span class="ansi-yellow-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(<span class="ansi-cyan-intense-fg ansi-bold">157</span>)forward()
-&gt; k = arange(Km1)
(Pdb++)
&gt; <span class="ansi-yellow-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(<span class="ansi-cyan-intense-fg ansi-bold">158</span>)forward()
-&gt; eq_share = - t.log(Km1 - k) # logit(1./(Km1 + 1 - k))
(Pdb++)
&gt; <span class="ansi-yellow-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(<span class="ansi-cyan-intense-fg ansi-bold">159</span>)forward()
-&gt; y = logit(z) - eq_share
(Pdb++)
&gt; <span class="ansi-yellow-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(<span class="ansi-cyan-intense-fg ansi-bold">160</span>)forward()
-&gt; return y
(Pdb++)
--Return--
&gt; <span class="ansi-yellow-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(<span class="ansi-cyan-intense-fg ansi-bold">160</span>)forward()-&gt;Elemwise...nplace}.0
-&gt; return y
(Pdb++)
&gt; <span class="ansi-yellow-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(<span class="ansi-cyan-intense-fg ansi-bold">50</span>)__init__()
-&gt; self.dist = dist
(Pdb++)
&gt; <span class="ansi-yellow-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span>(<span class="ansi-cyan-intense-fg ansi-bold">51</span>)__init__()
-&gt; self.transform_used = transform
(Pdb++) c
</pre></div></div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-5-9e38a501ad9d&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">      2</span> <span class="ansi-green-intense-fg ansi-bold">from</span> pymc3 <span class="ansi-green-intense-fg ansi-bold">import</span> Dirichlet<span class="ansi-yellow-intense-fg ansi-bold">,</span> Model
<span class="ansi-green-fg">      3</span> <span class="ansi-green-intense-fg ansi-bold">with</span> Model<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 4</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>Dirichlet<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;beta&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> np<span class="ansi-yellow-intense-fg ansi-bold">.</span>ones<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">2</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">3</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">__new__</span><span class="ansi-blue-intense-fg ansi-bold">(cls, name, *args, **kwargs)</span>
<span class="ansi-green-fg">     17</span>             data <span class="ansi-yellow-intense-fg ansi-bold">=</span> kwargs<span class="ansi-yellow-intense-fg ansi-bold">.</span>pop<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;observed&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> None<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     18</span>             dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> cls<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 19</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">return</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> data<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     20</span>         <span class="ansi-green-intense-fg ansi-bold">elif</span> name <span class="ansi-green-intense-fg ansi-bold">is</span> None<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     21</span>             <span class="ansi-green-intense-fg ansi-bold">return</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-red-intense-fg ansi-bold">#for pickle</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">Var</span><span class="ansi-blue-intense-fg ansi-bold">(self, name, dist, data)</span>
<span class="ansi-green-fg">    151</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>free_RVs<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    152</span>             <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 153</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>var <span class="ansi-yellow-intense-fg ansi-bold">=</span> TransformedRV<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">=</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> model<span class="ansi-yellow-intense-fg ansi-bold">=</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>transform<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    154</span>                 self<span class="ansi-yellow-intense-fg ansi-bold">.</span>deterministics<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>var<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    155</span>                 <span class="ansi-green-intense-fg ansi-bold">return</span> var

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, type, owner, index, name, distribution, model, transform)</span>
<span class="ansi-green-fg">    506</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>model <span class="ansi-yellow-intense-fg ansi-bold">=</span> model
<span class="ansi-green-fg">    507</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 508</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed <span class="ansi-yellow-intense-fg ansi-bold">=</span> model<span class="ansi-yellow-intense-fg ansi-bold">.</span>Var<span class="ansi-yellow-intense-fg ansi-bold">(</span>name <span class="ansi-yellow-intense-fg ansi-bold">+</span> <span class="ansi-blue-intense-fg ansi-bold">&#34;_&#34;</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>distribution<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    509</span>
<span class="ansi-green-fg">    510</span>             normalRV <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform<span class="ansi-yellow-intense-fg ansi-bold">.</span>backward<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transformed<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">apply</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist)</span>
<span class="ansi-green-fg">     23</span>
<span class="ansi-green-fg">     24</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> apply<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> dist<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 25</span><span class="ansi-yellow-intense-fg ansi-bold">         </span><span class="ansi-green-intense-fg ansi-bold">return</span> TransformedDistribution<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>dist<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     26</span>
<span class="ansi-green-fg">     27</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> __str__<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/distribution.py</span> in <span class="ansi-cyan-fg">dist</span><span class="ansi-blue-intense-fg ansi-bold">(cls, *args, **kwargs)</span>
<span class="ansi-green-fg">     29</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> dist<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     30</span>         dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> object<span class="ansi-yellow-intense-fg ansi-bold">.</span>__new__<span class="ansi-yellow-intense-fg ansi-bold">(</span>cls<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 31</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>dist<span class="ansi-yellow-intense-fg ansi-bold">.</span>__init__<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     32</span>         <span class="ansi-green-intense-fg ansi-bold">return</span> dist
<span class="ansi-green-fg">     33</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/transforms.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, dist, transform, *args, **kwargs)</span>
<span class="ansi-green-fg">     49</span>
<span class="ansi-green-fg">     50</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>dist <span class="ansi-yellow-intense-fg ansi-bold">=</span> dist
<span class="ansi-green-intense-fg ansi-bold">---&gt; 51</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>transform_used <span class="ansi-yellow-intense-fg ansi-bold">=</span> transform
<span class="ansi-green-fg">     52</span>         v <span class="ansi-yellow-intense-fg ansi-bold">=</span> forward<span class="ansi-yellow-intense-fg ansi-bold">(</span>FreeRV<span class="ansi-yellow-intense-fg ansi-bold">(</span>name<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;v&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">=</span>dist<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     53</span>         self<span class="ansi-yellow-intense-fg ansi-bold">.</span>type <span class="ansi-yellow-intense-fg ansi-bold">=</span> v<span class="ansi-yellow-intense-fg ansi-bold">.</span>type

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/model.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, type, owner, index, name, distribution, model)</span>
<span class="ansi-green-fg">    360</span>             self.tag.test_value = np.ones(
<span class="ansi-green-fg">    361</span>                 distribution.shape, distribution.dtype) * distribution.default()
<span class="ansi-green-intense-fg ansi-bold">--&gt; 362</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>logp_elemwiset <span class="ansi-yellow-intense-fg ansi-bold">=</span> distribution<span class="ansi-yellow-intense-fg ansi-bold">.</span>logp<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    363</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>model <span class="ansi-yellow-intense-fg ansi-bold">=</span> model
<span class="ansi-green-fg">    364</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/multivariate.py</span> in <span class="ansi-cyan-fg">logp</span><span class="ansi-blue-intense-fg ansi-bold">(self, value)</span>
<span class="ansi-green-fg">     83</span>         <span class="ansi-red-intense-fg ansi-bold"># only defined for sum(value) == 1</span>
<span class="ansi-green-fg">     84</span>         return bound(
<span class="ansi-green-intense-fg ansi-bold">---&gt; 85</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>sum<span class="ansi-yellow-intense-fg ansi-bold">(</span>logpow<span class="ansi-yellow-intense-fg ansi-bold">(</span>value<span class="ansi-yellow-intense-fg ansi-bold">,</span> a <span class="ansi-yellow-intense-fg ansi-bold">-</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">-</span> gammaln<span class="ansi-yellow-intense-fg ansi-bold">(</span>a<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> axis<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span> gammaln<span class="ansi-yellow-intense-fg ansi-bold">(</span>sum<span class="ansi-yellow-intense-fg ansi-bold">(</span>a<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">     86</span>             k <span class="ansi-yellow-intense-fg ansi-bold">&gt;</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">     87</span>             all<span class="ansi-yellow-intense-fg ansi-bold">(</span>a <span class="ansi-yellow-intense-fg ansi-bold">&gt;</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/working/projects/pymc/pymc3/distributions/dist_math.py</span> in <span class="ansi-cyan-fg">logpow</span><span class="ansi-blue-intense-fg ansi-bold">(x, m)</span>
<span class="ansi-green-fg">     54</span>     Calculates log<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">**</span>m<span class="ansi-yellow-intense-fg ansi-bold">)</span> since m<span class="ansi-yellow-intense-fg ansi-bold">*</span>log<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span> will fail when m<span class="ansi-yellow-intense-fg ansi-bold">,</span> x <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-cyan-intense-fg ansi-bold">0.</span>
<span class="ansi-green-fg">     55</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">---&gt; 56</span><span class="ansi-yellow-intense-fg ansi-bold">     </span><span class="ansi-green-intense-fg ansi-bold">return</span> switch<span class="ansi-yellow-intense-fg ansi-bold">(</span>eq<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">&amp;</span> eq<span class="ansi-yellow-intense-fg ansi-bold">(</span>m<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> m <span class="ansi-yellow-intense-fg ansi-bold">*</span> log<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     57</span>
<span class="ansi-green-fg">     58</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self, *inputs, **kwargs)</span>
<span class="ansi-green-fg">    515</span>             <span class="ansi-green-intense-fg ansi-bold">for</span> i<span class="ansi-yellow-intense-fg ansi-bold">,</span> ins <span class="ansi-green-intense-fg ansi-bold">in</span> enumerate<span class="ansi-yellow-intense-fg ansi-bold">(</span>node<span class="ansi-yellow-intense-fg ansi-bold">.</span>inputs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    516</span>                 <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 517</span><span class="ansi-yellow-intense-fg ansi-bold">                     </span>storage_map<span class="ansi-yellow-intense-fg ansi-bold">[</span>ins<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_get_test_value<span class="ansi-yellow-intense-fg ansi-bold">(</span>ins<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    518</span>                     compute_map<span class="ansi-yellow-intense-fg ansi-bold">[</span>ins<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span>True<span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    519</span>                 <span class="ansi-green-intense-fg ansi-bold">except</span> AttributeError<span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/op.py</span> in <span class="ansi-cyan-fg">_get_test_value</span><span class="ansi-blue-intense-fg ansi-bold">(cls, v)</span>
<span class="ansi-green-fg">    452</span>             <span class="ansi-red-intense-fg ansi-bold"># ensure that the test value is correct</span>
<span class="ansi-green-fg">    453</span>             <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 454</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>ret <span class="ansi-yellow-intense-fg ansi-bold">=</span> v<span class="ansi-yellow-intense-fg ansi-bold">.</span>type<span class="ansi-yellow-intense-fg ansi-bold">.</span>filter<span class="ansi-yellow-intense-fg ansi-bold">(</span>v<span class="ansi-yellow-intense-fg ansi-bold">.</span>tag<span class="ansi-yellow-intense-fg ansi-bold">.</span>test_value<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    455</span>             <span class="ansi-green-intense-fg ansi-bold">except</span> Exception <span class="ansi-green-intense-fg ansi-bold">as</span> e<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    456</span>                 <span class="ansi-red-intense-fg ansi-bold"># Better error message.</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/tensor/type.py</span> in <span class="ansi-cyan-fg">filter</span><span class="ansi-blue-intense-fg ansi-bold">(self, data, strict, allow_downcast)</span>
<span class="ansi-green-fg">    166</span>             raise TypeError(&#34;Wrong number of dimensions: expected %s,&#34;
<span class="ansi-green-fg">    167</span>                             &#34; got %s with shape %s.&#34; % (self.ndim, data.ndim,
<span class="ansi-green-intense-fg ansi-bold">--&gt; 168</span><span class="ansi-yellow-intense-fg ansi-bold">                                                         data.shape))
</span><span class="ansi-green-fg">    169</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-green-intense-fg ansi-bold">not</span> data<span class="ansi-yellow-intense-fg ansi-bold">.</span>flags<span class="ansi-yellow-intense-fg ansi-bold">.</span>aligned<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    170</span>             <span class="ansi-green-intense-fg ansi-bold">try</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-red-intense-fg ansi-bold">TypeError</span>: For compute_test_value, one input test value does not have the requested type.

The error when converting the test value to that variable type:
Wrong number of dimensions: expected 0, got 2 with shape (2, 3).
</pre></div></div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="highlight-ipython2"><div class="highlight"><pre>
<span></span><span class="n">z</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="n">w</span><span class="p">]</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">MissingInputError</span>                         Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-27-e9dffd0eab75&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>z<span class="ansi-yellow-intense-fg ansi-bold">[</span>d<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">[</span>w<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>eval<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/graph.py</span> in <span class="ansi-cyan-fg">eval</span><span class="ansi-blue-intense-fg ansi-bold">(self, inputs_to_values)</span>
<span class="ansi-green-fg">    412</span>         inputs <span class="ansi-yellow-intense-fg ansi-bold">=</span> tuple<span class="ansi-yellow-intense-fg ansi-bold">(</span>sorted<span class="ansi-yellow-intense-fg ansi-bold">(</span>inputs_to_values<span class="ansi-yellow-intense-fg ansi-bold">.</span>keys<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> key<span class="ansi-yellow-intense-fg ansi-bold">=</span>id<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    413</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-green-intense-fg ansi-bold">not</span> inputs <span class="ansi-green-intense-fg ansi-bold">in</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_fn_cache<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 414</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_fn_cache<span class="ansi-yellow-intense-fg ansi-bold">[</span>inputs<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">=</span> theano<span class="ansi-yellow-intense-fg ansi-bold">.</span>function<span class="ansi-yellow-intense-fg ansi-bold">(</span>inputs<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    415</span>         args <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span>inputs_to_values<span class="ansi-yellow-intense-fg ansi-bold">[</span>param<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> param <span class="ansi-green-intense-fg ansi-bold">in</span> inputs<span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    416</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/compile/function.py</span> in <span class="ansi-cyan-fg">function</span><span class="ansi-blue-intense-fg ansi-bold">(inputs, outputs, mode, updates, givens, no_default_updates, accept_inplace, name, rebuild_strict, allow_input_downcast, profile, on_unused_input)</span>
<span class="ansi-green-fg">    307</span>                    on_unused_input<span class="ansi-yellow-intense-fg ansi-bold">=</span>on_unused_input<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">    308</span>                    profile<span class="ansi-yellow-intense-fg ansi-bold">=</span>profile<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 309</span><span class="ansi-yellow-intense-fg ansi-bold">                    output_keys=output_keys)
</span><span class="ansi-green-fg">    310</span>     <span class="ansi-red-intense-fg ansi-bold"># We need to add the flag check_aliased inputs if we have any mutable or</span>
<span class="ansi-green-fg">    311</span>     <span class="ansi-red-intense-fg ansi-bold"># borrowed used defined inputs</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/compile/pfunc.py</span> in <span class="ansi-cyan-fg">pfunc</span><span class="ansi-blue-intense-fg ansi-bold">(params, outputs, mode, updates, givens, no_default_updates, accept_inplace, name, rebuild_strict, allow_input_downcast, profile, on_unused_input, output_keys)</span>
<span class="ansi-green-fg">    520</span>                          accept_inplace<span class="ansi-yellow-intense-fg ansi-bold">=</span>accept_inplace<span class="ansi-yellow-intense-fg ansi-bold">,</span> name<span class="ansi-yellow-intense-fg ansi-bold">=</span>name<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">    521</span>                          profile<span class="ansi-yellow-intense-fg ansi-bold">=</span>profile<span class="ansi-yellow-intense-fg ansi-bold">,</span> on_unused_input<span class="ansi-yellow-intense-fg ansi-bold">=</span>on_unused_input<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 522</span><span class="ansi-yellow-intense-fg ansi-bold">                          output_keys=output_keys)
</span><span class="ansi-green-fg">    523</span>
<span class="ansi-green-fg">    524</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/compile/function_module.py</span> in <span class="ansi-cyan-fg">orig_function</span><span class="ansi-blue-intense-fg ansi-bold">(inputs, outputs, mode, accept_inplace, name, profile, on_unused_input, output_keys)</span>
<span class="ansi-green-fg">   1520</span>                    profile<span class="ansi-yellow-intense-fg ansi-bold">=</span>profile<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-fg">   1521</span>                    on_unused_input<span class="ansi-yellow-intense-fg ansi-bold">=</span>on_unused_input<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1522</span><span class="ansi-yellow-intense-fg ansi-bold">                    </span>output_keys<span class="ansi-yellow-intense-fg ansi-bold">=</span>output_keys<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>create<span class="ansi-yellow-intense-fg ansi-bold">(</span>
<span class="ansi-green-fg">   1523</span>             defaults)
<span class="ansi-green-fg">   1524</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/compile/debugmode.py</span> in <span class="ansi-cyan-fg">function_maker</span><span class="ansi-blue-intense-fg ansi-bold">(self, i, o, m, *args, **kwargs)</span>
<span class="ansi-green-fg">   2554</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">   2555</span>         <span class="ansi-green-intense-fg ansi-bold">assert</span> m <span class="ansi-green-intense-fg ansi-bold">is</span> self
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2556</span><span class="ansi-yellow-intense-fg ansi-bold">         </span><span class="ansi-green-intense-fg ansi-bold">return</span> _Maker<span class="ansi-yellow-intense-fg ansi-bold">(</span>i<span class="ansi-yellow-intense-fg ansi-bold">,</span> o<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>optimizer<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">*</span>args<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2557</span>
<span class="ansi-green-fg">   2558</span>     def __init__(self,

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/compile/debugmode.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, inputs, outputs, optimizer, mode, accept_inplace, function_builder, profile, on_unused_input, output_keys)</span>
<span class="ansi-green-fg">   2270</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> i <span class="ansi-green-intense-fg ansi-bold">in</span> xrange<span class="ansi-yellow-intense-fg ansi-bold">(</span>mode<span class="ansi-yellow-intense-fg ansi-bold">.</span>stability_patience<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   2271</span>             fgraph, additional_outputs, equivalence_tracker = _optcheck_fgraph(
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2272</span><span class="ansi-yellow-intense-fg ansi-bold">                 inputs, outputs, accept_inplace)
</span><span class="ansi-green-fg">   2273</span>             fgraph<span class="ansi-yellow-intense-fg ansi-bold">.</span>equivalence_tracker <span class="ansi-yellow-intense-fg ansi-bold">=</span> equivalence_tracker
<span class="ansi-green-fg">   2274</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/compile/debugmode.py</span> in <span class="ansi-cyan-fg">_optcheck_fgraph</span><span class="ansi-blue-intense-fg ansi-bold">(input_specs, output_specs, accept_inplace)</span>
<span class="ansi-green-fg">    705</span>     equivalence_tracker <span class="ansi-yellow-intense-fg ansi-bold">=</span> _VariableEquivalenceTracker<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    706</span>     fgraph = gof.fg.FunctionGraph(orig_inputs, orig_outputs,
<span class="ansi-green-intense-fg ansi-bold">--&gt; 707</span><span class="ansi-yellow-intense-fg ansi-bold">                                   features=[equivalence_tracker])
</span><span class="ansi-green-fg">    708</span>     <span class="ansi-red-intense-fg ansi-bold"># DestroyHandler may not be needed yet, as there is usually no</span>
<span class="ansi-green-fg">    709</span>     <span class="ansi-red-intense-fg ansi-bold"># inplace operation in the graph at this stage. DestroyHandler</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/fg.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, inputs, outputs, features, clone)</span>
<span class="ansi-green-fg">    132</span>             self<span class="ansi-yellow-intense-fg ansi-bold">.</span>variables<span class="ansi-yellow-intense-fg ansi-bold">.</span>add<span class="ansi-yellow-intense-fg ansi-bold">(</span>input<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    133</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 134</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>__import_r__<span class="ansi-yellow-intense-fg ansi-bold">(</span>outputs<span class="ansi-yellow-intense-fg ansi-bold">,</span> reason<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#34;init&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    135</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> i<span class="ansi-yellow-intense-fg ansi-bold">,</span> output <span class="ansi-green-intense-fg ansi-bold">in</span> enumerate<span class="ansi-yellow-intense-fg ansi-bold">(</span>outputs<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    136</span>             output<span class="ansi-yellow-intense-fg ansi-bold">.</span>clients<span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#39;output&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> i<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/fg.py</span> in <span class="ansi-cyan-fg">__import_r__</span><span class="ansi-blue-intense-fg ansi-bold">(self, variables, reason)</span>
<span class="ansi-green-fg">    254</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> apply_node <span class="ansi-green-intense-fg ansi-bold">in</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span>r<span class="ansi-yellow-intense-fg ansi-bold">.</span>owner <span class="ansi-green-intense-fg ansi-bold">for</span> r <span class="ansi-green-intense-fg ansi-bold">in</span> variables <span class="ansi-green-intense-fg ansi-bold">if</span> r<span class="ansi-yellow-intense-fg ansi-bold">.</span>owner <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> None<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    255</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> apply_node <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">in</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>apply_nodes<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 256</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>__import__<span class="ansi-yellow-intense-fg ansi-bold">(</span>apply_node<span class="ansi-yellow-intense-fg ansi-bold">,</span> reason<span class="ansi-yellow-intense-fg ansi-bold">=</span>reason<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    257</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> r <span class="ansi-green-intense-fg ansi-bold">in</span> variables<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    258</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> r<span class="ansi-yellow-intense-fg ansi-bold">.</span>owner <span class="ansi-green-intense-fg ansi-bold">is</span> None <span class="ansi-green-intense-fg ansi-bold">and</span> <span class="ansi-green-intense-fg ansi-bold">not</span> isinstance<span class="ansi-yellow-intense-fg ansi-bold">(</span>r<span class="ansi-yellow-intense-fg ansi-bold">,</span> graph<span class="ansi-yellow-intense-fg ansi-bold">.</span>Constant<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">and</span> r <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">in</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>inputs<span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">/home/wiecki/envs/pymc3/local/lib/python2.7/site-packages/theano/gof/fg.py</span> in <span class="ansi-cyan-fg">__import__</span><span class="ansi-blue-intense-fg ansi-bold">(self, apply_node, check, reason)</span>
<span class="ansi-green-fg">    350</span>                                 <span class="ansi-blue-intense-fg ansi-bold">&#39;leading from this input to an output is %s. &#39;</span>
<span class="ansi-green-fg">    351</span>                                 <span class="ansi-blue-intense-fg ansi-bold">&#39;This chain may not be unique&#39;</span> <span class="ansi-yellow-intense-fg ansi-bold">%</span> str<span class="ansi-yellow-intense-fg ansi-bold">(</span>path<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">+</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 352</span><span class="ansi-yellow-intense-fg ansi-bold">                                 detailed_err_msg)
</span><span class="ansi-green-fg">    353</span>
<span class="ansi-green-fg">    354</span>                         <span class="ansi-red-intense-fg ansi-bold"># Standard error message</span>

<span class="ansi-red-intense-fg ansi-bold">MissingInputError</span>: A variable that is an input to the graph was neither provided as an input to the function nor given a value. A chain of variables leading from this input to an output is [z_0, Subtensor{int64}.0]. This chain may not be unique
</pre></div></div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, John Salvatier, Christopher Fonnesbeck, Thomas Wiecki.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>