

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>&lt;no title&gt; &mdash; PyMC3 3.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PyMC3 3.0 documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PyMC3
          

          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">PyMC3</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/notebooks/profiling.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<p>#Profiling
Sometimes computing the likelihood is not as fast as we would like. Theano provides handy profiling tools, which pymc3 provides a wrapper <code class="docutils literal"><span class="pre">model.profile</span></code> which returns a <code class="docutils literal"><span class="pre">ProfileStats</span></code> object. Here we&#8217;ll profile the likelihood and gradient for the stochastic volatility example.</p>
<p>First we build the model.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pymc3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pymc3.distributions.timeseries</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">returns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">get_data_file</span><span class="p">(</span><span class="s1">&#39;pymc3.examples&#39;</span><span class="p">,</span> <span class="s2">&quot;../data/SP500.csv&quot;</span><span class="p">))[</span><span class="o">-</span><span class="n">n</span><span class="p">:]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">Exponential</span><span class="p">(</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="o">.</span><span class="mo">02</span><span class="p">,</span> <span class="n">testval</span><span class="o">=.</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">nu</span> <span class="o">=</span> <span class="n">Exponential</span><span class="p">(</span><span class="s1">&#39;nu&#39;</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">GaussianRandomWalk</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">**</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">StudentT</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">s</span><span class="p">),</span> <span class="n">observed</span><span class="o">=</span><span class="n">returns</span><span class="p">)</span>
    

</pre></div>
</div>
<p>Then call profile and summarize it.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">logpt</span><span class="p">)</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Function</span> <span class="n">profiling</span>
<span class="o">==================</span>
  <span class="n">Message</span><span class="p">:</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">fonnescj</span><span class="o">/</span><span class="n">GitHub</span><span class="o">/</span><span class="n">pymc3</span><span class="o">/</span><span class="n">pymc3</span><span class="o">/</span><span class="n">model</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">197</span>
  <span class="n">Time</span> <span class="ow">in</span> <span class="mi">1000</span> <span class="n">calls</span> <span class="n">to</span> <span class="n">Function</span><span class="o">.</span><span class="n">__call__</span><span class="p">:</span> <span class="mf">6.456351e-02</span><span class="n">s</span>
  <span class="n">Time</span> <span class="ow">in</span> <span class="n">Function</span><span class="o">.</span><span class="n">fn</span><span class="o">.</span><span class="n">__call__</span><span class="p">:</span> <span class="mf">3.473592e-02</span><span class="n">s</span> <span class="p">(</span><span class="mf">53.801</span><span class="o">%</span><span class="p">)</span>
  <span class="n">Time</span> <span class="ow">in</span> <span class="n">thunks</span><span class="p">:</span> <span class="mf">2.467275e-02</span><span class="n">s</span> <span class="p">(</span><span class="mf">38.215</span><span class="o">%</span><span class="p">)</span>
  <span class="n">Total</span> <span class="nb">compile</span> <span class="n">time</span><span class="p">:</span> <span class="mf">3.600923e+00</span><span class="n">s</span>
    <span class="n">Number</span> <span class="n">of</span> <span class="n">Apply</span> <span class="n">nodes</span><span class="p">:</span> <span class="mi">26</span>
    <span class="n">Theano</span> <span class="n">Optimizer</span> <span class="n">time</span><span class="p">:</span> <span class="mf">9.634581e-01</span><span class="n">s</span>
       <span class="n">Theano</span> <span class="n">validate</span> <span class="n">time</span><span class="p">:</span> <span class="mf">2.970219e-03</span><span class="n">s</span>
    <span class="n">Theano</span> <span class="n">Linker</span> <span class="n">time</span> <span class="p">(</span><span class="n">includes</span> <span class="n">C</span><span class="p">,</span> <span class="n">CUDA</span> <span class="n">code</span> <span class="n">generation</span><span class="o">/</span><span class="n">compiling</span><span class="p">):</span> <span class="mf">2.587607e+00</span><span class="n">s</span>
       <span class="n">Import</span> <span class="n">time</span> <span class="mf">5.669570e-02</span><span class="n">s</span>

<span class="n">Time</span> <span class="ow">in</span> <span class="nb">all</span> <span class="n">call</span> <span class="n">to</span> <span class="n">theano</span><span class="o">.</span><span class="n">grad</span><span class="p">()</span> <span class="mf">2.964401e-02</span><span class="n">s</span>
<span class="n">Class</span>
<span class="o">---</span>
<span class="o">&lt;%</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">sum</span> <span class="o">%&gt;</span> <span class="o">&lt;</span><span class="n">apply</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">time</span> <span class="n">per</span> <span class="n">call</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="c1">#call&gt; &lt;#apply&gt; &lt;Class name&gt;</span>
  <span class="mf">85.4</span><span class="o">%</span>    <span class="mf">85.4</span><span class="o">%</span>       <span class="mf">0.021</span><span class="n">s</span>       <span class="mf">1.50e-06</span><span class="n">s</span>     <span class="n">C</span>    <span class="mi">14000</span>      <span class="mi">14</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">elemwise</span><span class="o">.</span><span class="n">Elemwise</span>
   <span class="mf">5.8</span><span class="o">%</span>    <span class="mf">91.2</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">3.59e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">4000</span>       <span class="mi">4</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">elemwise</span><span class="o">.</span><span class="n">Sum</span>
   <span class="mf">3.0</span><span class="o">%</span>    <span class="mf">94.2</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">3.76e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>       <span class="mi">2</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">subtensor</span><span class="o">.</span><span class="n">Subtensor</span>
   <span class="mf">2.4</span><span class="o">%</span>    <span class="mf">96.7</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">3.00e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>       <span class="mi">2</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">elemwise</span><span class="o">.</span><span class="n">DimShuffle</span>
   <span class="mf">2.1</span><span class="o">%</span>    <span class="mf">98.7</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">2.54e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>       <span class="mi">2</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">Flatten</span>
   <span class="mf">1.3</span><span class="o">%</span>   <span class="mf">100.0</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">1.58e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>       <span class="mi">2</span>   <span class="n">theano</span><span class="o">.</span><span class="n">compile</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">ViewOp</span>
   <span class="o">...</span> <span class="p">(</span><span class="n">remaining</span> <span class="mi">0</span> <span class="n">Classes</span> <span class="n">account</span> <span class="k">for</span>   <span class="mf">0.00</span><span class="o">%</span><span class="p">(</span><span class="mf">0.00</span><span class="n">s</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">runtime</span><span class="p">)</span>

<span class="n">Ops</span>
<span class="o">---</span>
<span class="o">&lt;%</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">sum</span> <span class="o">%&gt;</span> <span class="o">&lt;</span><span class="n">apply</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">time</span> <span class="n">per</span> <span class="n">call</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="c1">#call&gt; &lt;#apply&gt; &lt;Op name&gt;</span>
  <span class="mf">62.0</span><span class="o">%</span>    <span class="mf">62.0</span><span class="o">%</span>       <span class="mf">0.015</span><span class="n">s</span>       <span class="mf">1.53e-05</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">((</span><span class="n">GT</span><span class="p">(</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">),</span> <span class="n">i2</span><span class="p">)</span> <span class="o">*</span> <span class="n">i3</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">))),</span> <span class="n">i2</span><span class="p">)),</span> <span class="p">(((</span><span class="n">i4</span> <span class="o">+</span> <span class="p">(</span><span class="n">i5</span> <span class="o">*</span> <span class="n">log</span><span class="p">(((</span><span class="n">i6</span> <span class="o">*</span> <span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">))</span> <span class="o">/</span> <span class="n">i7</span><span class="p">))))</span> <span class="o">-</span> <span class="n">i8</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">i5</span> <span class="o">*</span> <span class="n">i9</span> <span class="o">*</span> <span class="n">log1p</span><span class="p">(((</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">i10</span><span class="p">)</span> <span class="o">/</span> <span class="n">i7</span><span class="p">)))),</span> <span class="n">i11</span><span class="p">)}}</span>
   <span class="mf">6.0</span><span class="o">%</span>    <span class="mf">68.0</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">7.36e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>        <span class="mi">2</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">log</span><span class="p">(</span><span class="n">Abs</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">i0</span><span class="p">)))}}</span>
   <span class="mf">5.8</span><span class="o">%</span>    <span class="mf">73.8</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">3.59e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">4000</span>        <span class="mi">4</span>   <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}</span>
   <span class="mf">5.0</span><span class="o">%</span>    <span class="mf">78.8</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">1.23e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="n">i1</span> <span class="o">*</span> <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">i2</span> <span class="o">*</span> <span class="n">sqr</span><span class="p">((</span><span class="n">i3</span> <span class="o">-</span> <span class="n">i4</span><span class="p">))))</span> <span class="o">+</span> <span class="n">i5</span><span class="p">)),</span> <span class="n">i6</span><span class="p">)}}</span>
   <span class="mf">2.6</span><span class="o">%</span>    <span class="mf">81.3</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">3.18e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>        <span class="mi">2</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">exp</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span>
   <span class="mf">2.6</span><span class="o">%</span>    <span class="mf">83.9</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">3.17e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>        <span class="mi">2</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">scalar_gammaln</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}</span>
   <span class="mf">2.4</span><span class="o">%</span>    <span class="mf">86.3</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">3.00e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>        <span class="mi">2</span>   <span class="n">InplaceDimShuffle</span><span class="p">{</span><span class="n">x</span><span class="p">}</span>
   <span class="mf">2.1</span><span class="o">%</span>    <span class="mf">88.4</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">2.54e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>        <span class="mi">2</span>   <span class="n">Flatten</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span>
   <span class="mf">2.0</span><span class="o">%</span>    <span class="mf">90.4</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">4.84e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">Switch</span><span class="p">(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">),</span> <span class="p">(</span><span class="n">i2</span> <span class="o">-</span> <span class="p">(</span><span class="n">i3</span> <span class="o">*</span> <span class="n">i0</span><span class="p">)),</span> <span class="n">i4</span><span class="p">)</span> <span class="o">+</span> <span class="n">i5</span> <span class="o">+</span> <span class="n">Switch</span><span class="p">(</span><span class="n">GT</span><span class="p">(</span><span class="n">i6</span><span class="p">,</span> <span class="n">i1</span><span class="p">),</span> <span class="p">(</span><span class="n">i7</span> <span class="o">-</span> <span class="p">(</span><span class="n">i8</span> <span class="o">*</span> <span class="n">i6</span><span class="p">)),</span> <span class="n">i4</span><span class="p">)</span> <span class="o">+</span> <span class="n">i9</span> <span class="o">+</span> <span class="n">i10</span> <span class="o">+</span> <span class="n">i11</span><span class="p">)}}[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
   <span class="mf">1.8</span><span class="o">%</span>    <span class="mf">92.2</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">4.42e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Subtensor</span><span class="p">{</span><span class="n">int64</span><span class="p">::}</span>
   <span class="mf">1.3</span><span class="o">%</span>    <span class="mf">93.4</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">1.58e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>        <span class="mi">2</span>   <span class="n">ViewOp</span>
   <span class="mf">1.3</span><span class="o">%</span>    <span class="mf">94.7</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">3.10e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Subtensor</span><span class="p">{:</span><span class="n">int64</span><span class="p">:}</span>
   <span class="mf">1.2</span><span class="o">%</span>    <span class="mf">95.8</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.85e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">log</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">97.0</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.74e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">98.0</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.60e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">inv</span><span class="p">(</span><span class="n">sqr</span><span class="p">(</span><span class="n">i0</span><span class="p">))}}</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">99.1</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.60e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">add</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span>
   <span class="mf">0.9</span><span class="o">%</span>   <span class="mf">100.0</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.32e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">gt</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span>
   <span class="o">...</span> <span class="p">(</span><span class="n">remaining</span> <span class="mi">0</span> <span class="n">Ops</span> <span class="n">account</span> <span class="k">for</span>   <span class="mf">0.00</span><span class="o">%</span><span class="p">(</span><span class="mf">0.00</span><span class="n">s</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">runtime</span><span class="p">)</span>

<span class="n">Apply</span>
<span class="o">------</span>
<span class="o">&lt;%</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">sum</span> <span class="o">%&gt;</span> <span class="o">&lt;</span><span class="n">apply</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">time</span> <span class="n">per</span> <span class="n">call</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="c1">#call&gt; &lt;id&gt; &lt;Apply name&gt;</span>
  <span class="mf">62.0</span><span class="o">%</span>    <span class="mf">62.0</span><span class="o">%</span>       <span class="mf">0.015</span><span class="n">s</span>       <span class="mf">1.53e-05</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">22</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">((</span><span class="n">GT</span><span class="p">(</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">),</span> <span class="n">i2</span><span class="p">)</span> <span class="o">*</span> <span class="n">i3</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">))),</span> <span class="n">i2</span><span class="p">)),</span> <span class="p">(((</span><span class="n">i4</span> <span class="o">+</span> <span class="p">(</span><span class="n">i5</span> <span class="o">*</span> <span class="n">log</span><span class="p">(((</span><span class="n">i6</span> <span class="o">*</span> <span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">))</span> <span class="o">/</span> <span class="n">i7</span><span class="p">))))</span> <span class="o">-</span> <span class="n">i8</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">i5</span> <span class="o">*</span> <span class="n">i9</span> <span class="o">*</span> <span class="n">log1p</span><span class="p">(((</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">i10</span><span class="p">)</span> <span class="o">/</span> <span class="n">i7</span><span class="p">)))),</span> <span class="n">i11</span><span class="p">)}}(</span><span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">},</span> <span class="n">s</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">0</span><span class="p">},</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">gt</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">scalar_gammaln</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mf">0.5</span><span class="p">},</span> <span class="n">Te</span>
   <span class="mf">5.0</span><span class="o">%</span>    <span class="mf">67.0</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">1.23e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">21</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="n">i1</span> <span class="o">*</span> <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">i2</span> <span class="o">*</span> <span class="n">sqr</span><span class="p">((</span><span class="n">i3</span> <span class="o">-</span> <span class="n">i4</span><span class="p">))))</span> <span class="o">+</span> <span class="n">i5</span><span class="p">)),</span> <span class="n">i6</span><span class="p">)}}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mf">0.5</span><span class="p">},</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">inv</span><span class="p">(</span><span class="n">sqr</span><span class="p">(</span><span class="n">i0</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Subtensor</span><span class="p">{</span><span class="n">int64</span><span class="p">::}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Subtensor</span><span class="p">{:</span><span class="n">int64</span><span class="p">:}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">log</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="o">-</span><span class="n">inf</span><span class="p">})</span>
   <span class="mf">5.0</span><span class="o">%</span>    <span class="mf">71.9</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">1.22e-06</span><span class="n">s</span>   <span class="mi">1000</span>     <span class="mi">7</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">log</span><span class="p">(</span><span class="n">Abs</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">i0</span><span class="p">)))}}(</span><span class="n">Flatten</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">2.3</span><span class="o">%</span>    <span class="mf">74.3</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">5.76e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">24</span>   <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">((</span><span class="n">GT</span><span class="p">(</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">),</span> <span class="n">i2</span><span class="p">)</span> <span class="o">*</span> <span class="n">i3</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">))),</span> <span class="n">i2</span><span class="p">)),</span> <span class="p">(((</span><span class="n">i4</span> <span class="o">+</span> <span class="p">(</span><span class="n">i5</span> <span class="o">*</span> <span class="n">log</span><span class="p">(((</span><span class="n">i6</span> <span class="o">*</span> <span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">))</span> <span class="o">/</span> <span class="n">i7</span><span class="p">))))</span> <span class="o">-</span> <span class="n">i8</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">i5</span> <span class="o">*</span> <span class="n">i9</span> <span class="o">*</span> <span class="n">log1p</span><span class="p">(((</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">i10</span><span class="p">)</span> <span class="o">/</span> <span class="n">i7</span><span class="p">)))),</span> <span class="n">i11</span><span class="p">)}}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">2.3</span><span class="o">%</span>    <span class="mf">76.6</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">5.68e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">23</span>   <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="n">i1</span> <span class="o">*</span> <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">i2</span> <span class="o">*</span> <span class="n">sqr</span><span class="p">((</span><span class="n">i3</span> <span class="o">-</span> <span class="n">i4</span><span class="p">))))</span> <span class="o">+</span> <span class="n">i5</span><span class="p">)),</span> <span class="n">i6</span><span class="p">)}}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">2.0</span><span class="o">%</span>    <span class="mf">78.5</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">4.84e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">25</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">Switch</span><span class="p">(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">),</span> <span class="p">(</span><span class="n">i2</span> <span class="o">-</span> <span class="p">(</span><span class="n">i3</span> <span class="o">*</span> <span class="n">i0</span><span class="p">)),</span> <span class="n">i4</span><span class="p">)</span> <span class="o">+</span> <span class="n">i5</span> <span class="o">+</span> <span class="n">Switch</span><span class="p">(</span><span class="n">GT</span><span class="p">(</span><span class="n">i6</span><span class="p">,</span> <span class="n">i1</span><span class="p">),</span> <span class="p">(</span><span class="n">i7</span> <span class="o">-</span> <span class="p">(</span><span class="n">i8</span> <span class="o">*</span> <span class="n">i6</span><span class="p">)),</span> <span class="n">i4</span><span class="p">)</span> <span class="o">+</span> <span class="n">i9</span> <span class="o">+</span> <span class="n">i10</span> <span class="o">+</span> <span class="n">i11</span><span class="p">)}}[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)](</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">exp</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span> <span class="n">TensorConstant</span><span class="p">{</span><span class="mf">3.9120230674743652</span><span class="p">},</span> <span class="n">TensorConstant</span><span class="p">{</span><span class="mf">50.0</span><span class="p">},</span> <span class="n">TensorConstant</span><span class="p">{</span><span class="o">-</span><span class="n">inf</span><span class="p">},</span> <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">exp</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{</span><span class="o">-</span><span class="mf">2.3025850929940455</span><span class="p">},</span> <span class="n">TensorConstant</span><span class="p">{</span><span class="mf">0.1</span><span class="p">},</span> <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">1.8</span><span class="o">%</span>    <span class="mf">80.3</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">4.42e-07</span><span class="n">s</span>   <span class="mi">1000</span>     <span class="mi">5</span>   <span class="n">Subtensor</span><span class="p">{</span><span class="n">int64</span><span class="p">::}(</span><span class="n">s</span><span class="p">,</span> <span class="n">Constant</span><span class="p">{</span><span class="mi">1</span><span class="p">})</span>
   <span class="mf">1.5</span><span class="o">%</span>    <span class="mf">81.8</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">3.74e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">10</span>   <span class="n">InplaceDimShuffle</span><span class="p">{</span><span class="n">x</span><span class="p">}(</span><span class="n">sigma</span><span class="p">)</span>
   <span class="mf">1.5</span><span class="o">%</span>    <span class="mf">83.3</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">3.60e-07</span><span class="n">s</span>   <span class="mi">1000</span>     <span class="mi">0</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">exp</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}(</span><span class="n">sigma_log</span><span class="p">)</span>
   <span class="mf">1.3</span><span class="o">%</span>    <span class="mf">84.6</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">3.18e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">16</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">scalar_gammaln</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}(</span><span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mf">0.5</span><span class="p">},</span> <span class="n">InplaceDimShuffle</span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">1.3</span><span class="o">%</span>    <span class="mf">85.9</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">3.16e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">20</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">scalar_gammaln</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}(</span><span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mf">0.5</span><span class="p">},</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">add</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">1.3</span><span class="o">%</span>    <span class="mf">87.1</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">3.10e-07</span><span class="n">s</span>   <span class="mi">1000</span>     <span class="mi">4</span>   <span class="n">Subtensor</span><span class="p">{:</span><span class="n">int64</span><span class="p">:}(</span><span class="n">s</span><span class="p">,</span> <span class="n">Constant</span><span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">})</span>
   <span class="mf">1.2</span><span class="o">%</span>    <span class="mf">88.3</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">3.03e-07</span><span class="n">s</span>   <span class="mi">1000</span>     <span class="mi">1</span>   <span class="n">Flatten</span><span class="p">{</span><span class="mi">1</span><span class="p">}(</span><span class="n">sigma_log</span><span class="p">)</span>
   <span class="mf">1.2</span><span class="o">%</span>    <span class="mf">89.5</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.85e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">18</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">log</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}(</span><span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mf">0.</span><span class="o">..</span><span class="mi">9154943092</span><span class="p">},</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">inv</span><span class="p">(</span><span class="n">sqr</span><span class="p">(</span><span class="n">i0</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">90.6</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.77e-07</span><span class="n">s</span>   <span class="mi">1000</span>     <span class="mi">2</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">exp</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}(</span><span class="n">nu_log</span><span class="p">)</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">91.7</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.74e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">19</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">inv</span><span class="p">(</span><span class="n">sqr</span><span class="p">(</span><span class="n">i0</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">0</span><span class="p">})</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">92.8</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.60e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">15</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">add</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}(</span><span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mf">1.0</span><span class="p">},</span> <span class="n">InplaceDimShuffle</span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">93.8</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.60e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">14</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">inv</span><span class="p">(</span><span class="n">sqr</span><span class="p">(</span><span class="n">i0</span><span class="p">))}}(</span><span class="n">InplaceDimShuffle</span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">1.0</span><span class="o">%</span>    <span class="mf">94.9</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.49e-07</span><span class="n">s</span>   <span class="mi">1000</span>     <span class="mi">9</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">log</span><span class="p">(</span><span class="n">Abs</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">i0</span><span class="p">)))}}(</span><span class="n">Flatten</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">0.9</span><span class="o">%</span>    <span class="mf">95.8</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.32e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">17</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">gt</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}(</span><span class="n">InplaceDimShuffle</span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">0</span><span class="p">})</span>
   <span class="o">...</span> <span class="p">(</span><span class="n">remaining</span> <span class="mi">6</span> <span class="n">Apply</span> <span class="n">instances</span> <span class="n">account</span> <span class="k">for</span> <span class="mf">4.21</span><span class="o">%</span><span class="p">(</span><span class="mf">0.00</span><span class="n">s</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">runtime</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">gradient</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">logpt</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">vars</span><span class="p">))</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Function</span> <span class="n">profiling</span>
<span class="o">==================</span>
  <span class="n">Message</span><span class="p">:</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">fonnescj</span><span class="o">/</span><span class="n">GitHub</span><span class="o">/</span><span class="n">pymc3</span><span class="o">/</span><span class="n">pymc3</span><span class="o">/</span><span class="n">model</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">197</span>
  <span class="n">Time</span> <span class="ow">in</span> <span class="mi">1000</span> <span class="n">calls</span> <span class="n">to</span> <span class="n">Function</span><span class="o">.</span><span class="n">__call__</span><span class="p">:</span> <span class="mf">1.570358e-01</span><span class="n">s</span>
  <span class="n">Time</span> <span class="ow">in</span> <span class="n">Function</span><span class="o">.</span><span class="n">fn</span><span class="o">.</span><span class="n">__call__</span><span class="p">:</span> <span class="mf">1.222701e-01</span><span class="n">s</span> <span class="p">(</span><span class="mf">77.861</span><span class="o">%</span><span class="p">)</span>
  <span class="n">Time</span> <span class="ow">in</span> <span class="n">thunks</span><span class="p">:</span> <span class="mf">9.528661e-02</span><span class="n">s</span> <span class="p">(</span><span class="mf">60.678</span><span class="o">%</span><span class="p">)</span>
  <span class="n">Total</span> <span class="nb">compile</span> <span class="n">time</span><span class="p">:</span> <span class="mf">5.955295e+00</span><span class="n">s</span>
    <span class="n">Number</span> <span class="n">of</span> <span class="n">Apply</span> <span class="n">nodes</span><span class="p">:</span> <span class="mi">55</span>
    <span class="n">Theano</span> <span class="n">Optimizer</span> <span class="n">time</span><span class="p">:</span> <span class="mf">8.904371e-01</span><span class="n">s</span>
       <span class="n">Theano</span> <span class="n">validate</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.370955e-02</span><span class="n">s</span>
    <span class="n">Theano</span> <span class="n">Linker</span> <span class="n">time</span> <span class="p">(</span><span class="n">includes</span> <span class="n">C</span><span class="p">,</span> <span class="n">CUDA</span> <span class="n">code</span> <span class="n">generation</span><span class="o">/</span><span class="n">compiling</span><span class="p">):</span> <span class="mf">4.988965e+00</span><span class="n">s</span>
       <span class="n">Import</span> <span class="n">time</span> <span class="mf">1.071918e-01</span><span class="n">s</span>

<span class="n">Time</span> <span class="ow">in</span> <span class="nb">all</span> <span class="n">call</span> <span class="n">to</span> <span class="n">theano</span><span class="o">.</span><span class="n">grad</span><span class="p">()</span> <span class="mf">1.577589e+00</span><span class="n">s</span>
<span class="n">Class</span>
<span class="o">---</span>
<span class="o">&lt;%</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">sum</span> <span class="o">%&gt;</span> <span class="o">&lt;</span><span class="n">apply</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">time</span> <span class="n">per</span> <span class="n">call</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="c1">#call&gt; &lt;#apply&gt; &lt;Class name&gt;</span>
  <span class="mf">47.2</span><span class="o">%</span>    <span class="mf">47.2</span><span class="o">%</span>       <span class="mf">0.045</span><span class="n">s</span>       <span class="mf">2.25e-05</span><span class="n">s</span>     <span class="n">Py</span>    <span class="mi">2000</span>       <span class="mi">2</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">Split</span>
  <span class="mf">31.9</span><span class="o">%</span>    <span class="mf">79.1</span><span class="o">%</span>       <span class="mf">0.030</span><span class="n">s</span>       <span class="mf">1.12e-06</span><span class="n">s</span>     <span class="n">C</span>    <span class="mi">27000</span>      <span class="mi">27</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">elemwise</span><span class="o">.</span><span class="n">Elemwise</span>
   <span class="mf">4.7</span><span class="o">%</span>    <span class="mf">83.8</span><span class="o">%</span>       <span class="mf">0.005</span><span class="n">s</span>       <span class="mf">6.45e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">7000</span>       <span class="mi">7</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">elemwise</span><span class="o">.</span><span class="n">Sum</span>
   <span class="mf">4.5</span><span class="o">%</span>    <span class="mf">88.3</span><span class="o">%</span>       <span class="mf">0.004</span><span class="n">s</span>       <span class="mf">2.14e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>       <span class="mi">2</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">subtensor</span><span class="o">.</span><span class="n">IncSubtensor</span>
   <span class="mf">3.9</span><span class="o">%</span>    <span class="mf">92.3</span><span class="o">%</span>       <span class="mf">0.004</span><span class="n">s</span>       <span class="mf">3.76e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>       <span class="mi">1</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">Join</span>
   <span class="mf">2.6</span><span class="o">%</span>    <span class="mf">94.9</span><span class="o">%</span>       <span class="mf">0.002</span><span class="n">s</span>       <span class="mf">2.49e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>       <span class="mi">1</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">Alloc</span>
   <span class="mf">1.3</span><span class="o">%</span>    <span class="mf">96.2</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">2.55e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">5000</span>       <span class="mi">5</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">Flatten</span>
   <span class="mf">1.2</span><span class="o">%</span>    <span class="mf">97.4</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">5.80e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>       <span class="mi">2</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">subtensor</span><span class="o">.</span><span class="n">Subtensor</span>
   <span class="mf">0.9</span><span class="o">%</span>    <span class="mf">98.4</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">4.49e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>       <span class="mi">2</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">basic</span><span class="o">.</span><span class="n">Reshape</span>
   <span class="mf">0.9</span><span class="o">%</span>    <span class="mf">99.3</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">2.94e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">3000</span>       <span class="mi">3</span>   <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="o">.</span><span class="n">elemwise</span><span class="o">.</span><span class="n">DimShuffle</span>
   <span class="mf">0.4</span><span class="o">%</span>    <span class="mf">99.7</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.08e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>       <span class="mi">2</span>   <span class="n">theano</span><span class="o">.</span><span class="n">compile</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">ViewOp</span>
   <span class="mf">0.3</span><span class="o">%</span>   <span class="mf">100.0</span><span class="o">%</span>       <span class="mf">0.000</span><span class="n">s</span>       <span class="mf">2.51e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>       <span class="mi">1</span>   <span class="n">theano</span><span class="o">.</span><span class="n">compile</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">Shape_i</span>
   <span class="o">...</span> <span class="p">(</span><span class="n">remaining</span> <span class="mi">0</span> <span class="n">Classes</span> <span class="n">account</span> <span class="k">for</span>   <span class="mf">0.00</span><span class="o">%</span><span class="p">(</span><span class="mf">0.00</span><span class="n">s</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">runtime</span><span class="p">)</span>

<span class="n">Ops</span>
<span class="o">---</span>
<span class="o">&lt;%</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">sum</span> <span class="o">%&gt;</span> <span class="o">&lt;</span><span class="n">apply</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">time</span> <span class="n">per</span> <span class="n">call</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="c1">#call&gt; &lt;#apply&gt; &lt;Op name&gt;</span>
  <span class="mf">47.2</span><span class="o">%</span>    <span class="mf">47.2</span><span class="o">%</span>       <span class="mf">0.045</span><span class="n">s</span>       <span class="mf">2.25e-05</span><span class="n">s</span>     <span class="n">Py</span>    <span class="mi">2000</span>        <span class="mi">2</span>   <span class="n">Split</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span>
   <span class="mf">7.4</span><span class="o">%</span>    <span class="mf">54.6</span><span class="o">%</span>       <span class="mf">0.007</span><span class="n">s</span>       <span class="mf">7.04e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">log1p</span><span class="p">((</span><span class="n">i1</span> <span class="o">/</span> <span class="n">i2</span><span class="p">))),</span> <span class="n">i3</span><span class="p">)}}</span>
   <span class="mf">4.7</span><span class="o">%</span>    <span class="mf">59.4</span><span class="o">%</span>       <span class="mf">0.005</span><span class="n">s</span>       <span class="mf">6.45e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">7000</span>        <span class="mi">7</span>   <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}</span>
   <span class="mf">3.9</span><span class="o">%</span>    <span class="mf">63.3</span><span class="o">%</span>       <span class="mf">0.004</span><span class="n">s</span>       <span class="mf">3.76e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Join</span>
   <span class="mf">3.1</span><span class="o">%</span>    <span class="mf">66.4</span><span class="o">%</span>       <span class="mf">0.003</span><span class="n">s</span>       <span class="mf">2.94e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}</span>
   <span class="mf">3.1</span><span class="o">%</span>    <span class="mf">69.5</span><span class="o">%</span>       <span class="mf">0.003</span><span class="n">s</span>       <span class="mf">2.93e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">IncSubtensor</span><span class="p">{</span><span class="n">InplaceInc</span><span class="p">;</span><span class="n">int64</span><span class="p">::}</span>
   <span class="mf">3.0</span><span class="o">%</span>    <span class="mf">72.4</span><span class="o">%</span>       <span class="mf">0.003</span><span class="n">s</span>       <span class="mf">7.03e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">4000</span>        <span class="mi">4</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Switch</span><span class="p">}</span>
   <span class="mf">2.8</span><span class="o">%</span>    <span class="mf">75.2</span><span class="o">%</span>       <span class="mf">0.003</span><span class="n">s</span>       <span class="mf">2.65e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">((</span><span class="n">i1</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">i3</span> <span class="o">*</span> <span class="n">i4</span><span class="p">)</span> <span class="o">/</span> <span class="n">i5</span><span class="p">),</span> <span class="n">i6</span><span class="p">)}}</span>
   <span class="mf">2.8</span><span class="o">%</span>    <span class="mf">78.0</span><span class="o">%</span>       <span class="mf">0.003</span><span class="n">s</span>       <span class="mf">2.64e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">i0</span> <span class="o">*</span> <span class="p">(</span><span class="n">Switch</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span><span class="p">)</span> <span class="o">+</span> <span class="n">Switch</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="p">((</span><span class="n">i4</span> <span class="o">*</span> <span class="n">i5</span> <span class="o">*</span> <span class="n">i6</span> <span class="o">*</span> <span class="n">i7</span><span class="p">)</span> <span class="o">/</span> <span class="n">i8</span><span class="p">),</span> <span class="n">i3</span><span class="p">)))}}[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)]</span>
   <span class="mf">2.6</span><span class="o">%</span>    <span class="mf">80.6</span><span class="o">%</span>       <span class="mf">0.002</span><span class="n">s</span>       <span class="mf">2.49e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Alloc</span>
   <span class="mf">2.3</span><span class="o">%</span>    <span class="mf">82.9</span><span class="o">%</span>       <span class="mf">0.002</span><span class="n">s</span>       <span class="mf">2.22e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}</span>
   <span class="mf">1.4</span><span class="o">%</span>    <span class="mf">84.3</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">1.34e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">IncSubtensor</span><span class="p">{</span><span class="n">InplaceInc</span><span class="p">;:</span><span class="n">int64</span><span class="p">:}</span>
   <span class="mf">1.3</span><span class="o">%</span>    <span class="mf">85.7</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">2.55e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">5000</span>        <span class="mi">5</span>   <span class="n">Flatten</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span>
   <span class="mf">1.2</span><span class="o">%</span>    <span class="mf">86.8</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">1.13e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="n">i1</span> <span class="o">*</span> <span class="n">sqr</span><span class="p">(</span><span class="n">i2</span><span class="p">)),</span> <span class="n">i3</span><span class="p">)}}</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">88.0</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">1.09e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{((((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span> <span class="o">*</span> <span class="n">scalar_psi</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i2</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="n">i3</span> <span class="o">*</span> <span class="p">(</span><span class="n">i4</span> <span class="o">/</span> <span class="n">sqr</span><span class="p">(</span><span class="n">i5</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i6</span> <span class="o">*</span> <span class="n">scalar_psi</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i5</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i7</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">i8</span> <span class="o">/</span> <span class="n">i5</span><span class="p">))</span> <span class="o">*</span> <span class="n">i9</span><span class="p">)</span> <span class="o">+</span> <span class="n">Switch</span><span class="p">(</span><span class="n">GT</span><span class="p">(</span><span class="n">i9</span><span class="p">,</span> <span class="n">i10</span><span class="p">),</span> <span class="p">(</span><span class="n">i11</span> <span class="o">*</span> <span class="n">i9</span><span class="p">),</span> <span class="n">i10</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">i12</span> <span class="o">*</span> <span class="n">i9</span><span class="p">))}}[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">89.1</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">1.05e-06</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">1000</span>        <span class="mi">1</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="n">i1</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">i3</span><span class="p">),</span> <span class="n">i4</span><span class="p">)}}</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">90.2</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">5.16e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>        <span class="mi">2</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">mul</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span>
   <span class="mf">0.9</span><span class="o">%</span>    <span class="mf">91.1</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">4.49e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>        <span class="mi">2</span>   <span class="n">Reshape</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span>
   <span class="mf">0.9</span><span class="o">%</span>    <span class="mf">92.0</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">2.94e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">3000</span>        <span class="mi">3</span>   <span class="n">InplaceDimShuffle</span><span class="p">{</span><span class="n">x</span><span class="p">}</span>
   <span class="mf">0.9</span><span class="o">%</span>    <span class="mf">93.0</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">4.41e-07</span><span class="n">s</span>     <span class="n">C</span>     <span class="mi">2000</span>        <span class="mi">2</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">exp</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span>
   <span class="o">...</span> <span class="p">(</span><span class="n">remaining</span> <span class="mi">14</span> <span class="n">Ops</span> <span class="n">account</span> <span class="k">for</span>   <span class="mf">7.03</span><span class="o">%</span><span class="p">(</span><span class="mf">0.01</span><span class="n">s</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">runtime</span><span class="p">)</span>

<span class="n">Apply</span>
<span class="o">------</span>
<span class="o">&lt;%</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">sum</span> <span class="o">%&gt;</span> <span class="o">&lt;</span><span class="n">apply</span> <span class="n">time</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">time</span> <span class="n">per</span> <span class="n">call</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="c1">#call&gt; &lt;id&gt; &lt;Apply name&gt;</span>
  <span class="mf">25.7</span><span class="o">%</span>    <span class="mf">25.7</span><span class="o">%</span>       <span class="mf">0.024</span><span class="n">s</span>       <span class="mf">2.45e-05</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">16</span>   <span class="n">Split</span><span class="p">{</span><span class="mi">1</span><span class="p">}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">sgn</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">i0</span><span class="p">))</span> <span class="o">/</span> <span class="n">Abs</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">i0</span><span class="p">)))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">1</span><span class="p">})</span>
  <span class="mf">21.5</span><span class="o">%</span>    <span class="mf">47.2</span><span class="o">%</span>       <span class="mf">0.021</span><span class="n">s</span>       <span class="mf">2.05e-05</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">19</span>   <span class="n">Split</span><span class="p">{</span><span class="mi">1</span><span class="p">}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">sgn</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">i0</span><span class="p">))</span> <span class="o">/</span> <span class="n">Abs</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">i0</span><span class="p">)))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">1</span><span class="p">})</span>
   <span class="mf">7.4</span><span class="o">%</span>    <span class="mf">54.6</span><span class="o">%</span>       <span class="mf">0.007</span><span class="n">s</span>       <span class="mf">7.04e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">31</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">log1p</span><span class="p">((</span><span class="n">i1</span> <span class="o">/</span> <span class="n">i2</span><span class="p">))),</span> <span class="n">i3</span><span class="p">)}}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">mul</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">InplaceDimShuffle</span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">0</span><span class="p">})</span>
   <span class="mf">3.9</span><span class="o">%</span>    <span class="mf">58.6</span><span class="o">%</span>       <span class="mf">0.004</span><span class="n">s</span>       <span class="mf">3.76e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">54</span>   <span class="n">Join</span><span class="p">(</span><span class="n">TensorConstant</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span> <span class="n">Flatten</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">3.1</span><span class="o">%</span>    <span class="mf">61.6</span><span class="o">%</span>       <span class="mf">0.003</span><span class="n">s</span>       <span class="mf">2.94e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">27</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">0</span><span class="p">},</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">gt</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">3.1</span><span class="o">%</span>    <span class="mf">64.7</span><span class="o">%</span>       <span class="mf">0.003</span><span class="n">s</span>       <span class="mf">2.93e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">48</span>   <span class="n">IncSubtensor</span><span class="p">{</span><span class="n">InplaceInc</span><span class="p">;</span><span class="n">int64</span><span class="p">::}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">i0</span> <span class="o">*</span> <span class="p">(</span><span class="n">Switch</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span><span class="p">)</span> <span class="o">+</span> <span class="n">Switch</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="p">((</span><span class="n">i4</span> <span class="o">*</span> <span class="n">i5</span> <span class="o">*</span> <span class="n">i6</span> <span class="o">*</span> <span class="n">i7</span><span class="p">)</span> <span class="o">/</span> <span class="n">i8</span><span class="p">),</span> <span class="n">i3</span><span class="p">)))}}[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)]</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="n">i1</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">i3</span><span class="p">),</span> <span class="n">i4</span><span class="p">)}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Constant</span><span class="p">{</span><span class="mi">1</span><span class="p">})</span>
   <span class="mf">2.8</span><span class="o">%</span>    <span class="mf">67.5</span><span class="o">%</span>       <span class="mf">0.003</span><span class="n">s</span>       <span class="mf">2.65e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">43</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">((</span><span class="n">i1</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">i3</span> <span class="o">*</span> <span class="n">i4</span><span class="p">)</span> <span class="o">/</span> <span class="n">i5</span><span class="p">),</span> <span class="n">i6</span><span class="p">)}}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mf">0.5</span><span class="p">},</span> <span class="n">InplaceDimShuffle</span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{[</span>  <span class="mf">4.05769</span><span class="o">..</span><span class="mi">48400</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span><span class="p">]},</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Add</span><span class="p">}[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">0</span><span class="p">})</span>
   <span class="mf">2.8</span><span class="o">%</span>    <span class="mf">70.3</span><span class="o">%</span>       <span class="mf">0.003</span><span class="n">s</span>       <span class="mf">2.64e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">45</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">i0</span> <span class="o">*</span> <span class="p">(</span><span class="n">Switch</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span><span class="p">)</span> <span class="o">+</span> <span class="n">Switch</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="p">((</span><span class="n">i4</span> <span class="o">*</span> <span class="n">i5</span> <span class="o">*</span> <span class="n">i6</span> <span class="o">*</span> <span class="n">i7</span><span class="p">)</span> <span class="o">/</span> <span class="n">i8</span><span class="p">),</span> <span class="n">i3</span><span class="p">)))}}[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)](</span><span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">},</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mf">0.5</span><span class="p">},</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">0</span><span class="p">},</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">},</span> <span class="n">InplaceDimShuffle</span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{[</span>  <span class="mf">4.05769</span><span class="o">..</span><span class="mi">48400</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span><span class="p">]},</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Add</span><span class="p">}[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">2.6</span><span class="o">%</span>    <span class="mf">72.9</span><span class="o">%</span>       <span class="mf">0.002</span><span class="n">s</span>       <span class="mf">2.49e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">38</span>   <span class="n">Alloc</span><span class="p">(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Switch</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">i0</span> <span class="o">-</span> <span class="n">Switch</span><span class="p">(</span><span class="n">LT</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">i0</span><span class="p">),</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i0</span><span class="p">))}}[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">2.3</span><span class="o">%</span>    <span class="mf">75.2</span><span class="o">%</span>       <span class="mf">0.002</span><span class="n">s</span>       <span class="mf">2.22e-06</span><span class="n">s</span>   <span class="mi">1000</span>     <span class="mi">7</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">exp</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span><span class="p">))}}(</span><span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">},</span> <span class="n">s</span><span class="p">)</span>
   <span class="mf">1.4</span><span class="o">%</span>    <span class="mf">76.6</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">1.34e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">51</span>   <span class="n">IncSubtensor</span><span class="p">{</span><span class="n">InplaceInc</span><span class="p">;:</span><span class="n">int64</span><span class="p">:}(</span><span class="n">IncSubtensor</span><span class="p">{</span><span class="n">InplaceInc</span><span class="p">;</span><span class="n">int64</span><span class="p">::}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="n">i1</span> <span class="o">*</span> <span class="n">i2</span><span class="p">),</span> <span class="n">i3</span><span class="p">)}}[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Constant</span><span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">})</span>
   <span class="mf">1.2</span><span class="o">%</span>    <span class="mf">77.8</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">1.13e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">29</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="n">i1</span> <span class="o">*</span> <span class="n">sqr</span><span class="p">(</span><span class="n">i2</span><span class="p">)),</span> <span class="n">i3</span><span class="p">)}}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mf">0.5</span><span class="p">},</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">sub</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">0</span><span class="p">})</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">79.0</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">1.09e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">49</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{((((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i1</span> <span class="o">*</span> <span class="n">scalar_psi</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i2</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="n">i3</span> <span class="o">*</span> <span class="p">(</span><span class="n">i4</span> <span class="o">/</span> <span class="n">sqr</span><span class="p">(</span><span class="n">i5</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i6</span> <span class="o">*</span> <span class="n">scalar_psi</span><span class="p">((</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i5</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="n">i0</span> <span class="o">*</span> <span class="n">i7</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">i8</span> <span class="o">/</span> <span class="n">i5</span><span class="p">))</span> <span class="o">*</span> <span class="n">i9</span><span class="p">)</span> <span class="o">+</span> <span class="n">Switch</span><span class="p">(</span><span class="n">GT</span><span class="p">(</span><span class="n">i9</span><span class="p">,</span> <span class="n">i10</span><span class="p">),</span> <span class="p">(</span><span class="n">i11</span> <span class="o">*</span> <span class="n">i9</span><span class="p">),</span> <span class="n">i10</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">i12</span> <span class="o">*</span> <span class="n">i9</span><span class="p">))}}[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)](</span><span class="n">TensorConstant</span><span class="p">{</span><span class="mf">0.5</span><span class="p">},</span> <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">add</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{</span><span class="mf">3.141592653589793</span><span class="p">},</span> <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">exp</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span><span class="o">.</span>
   <span class="mf">1.1</span><span class="o">%</span>    <span class="mf">80.1</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">1.05e-06</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">28</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="n">i1</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">i3</span><span class="p">),</span> <span class="n">i4</span><span class="p">)}}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">},</span> <span class="n">InplaceDimShuffle</span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">sub</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">0</span><span class="p">})</span>
   <span class="mf">1.0</span><span class="o">%</span>    <span class="mf">81.0</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">9.33e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">34</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">Switch</span><span class="p">}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mf">1.0</span><span class="p">},</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mf">0.0</span><span class="p">})</span>
   <span class="mf">0.9</span><span class="o">%</span>    <span class="mf">81.9</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">8.37e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">33</span>   <span class="n">Elemwise</span><span class="p">{</span><span class="n">switch</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{(</span><span class="n">GT</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">GT</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i0</span><span class="p">)),</span> <span class="n">i1</span><span class="p">))}}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">Elemwise</span><span class="p">{</span><span class="n">mul</span><span class="p">,</span><span class="n">no_inplace</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">TensorConstant</span><span class="p">{(</span><span class="mi">1</span><span class="p">,)</span> <span class="n">of</span> <span class="mi">0</span><span class="p">})</span>
   <span class="mf">0.7</span><span class="o">%</span>    <span class="mf">82.7</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">7.03e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">44</span>   <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}(</span><span class="n">Alloc</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">0.7</span><span class="o">%</span>    <span class="mf">83.4</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">6.97e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">46</span>   <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">((</span><span class="n">i1</span> <span class="o">*</span> <span class="n">i2</span> <span class="o">*</span> <span class="n">i3</span> <span class="o">*</span> <span class="n">i4</span><span class="p">)</span> <span class="o">/</span> <span class="n">i5</span><span class="p">),</span> <span class="n">i6</span><span class="p">)}}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">0.7</span><span class="o">%</span>    <span class="mf">84.1</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">6.86e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">39</span>   <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Composite</span><span class="p">{</span><span class="n">Switch</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">log1p</span><span class="p">((</span><span class="n">i1</span> <span class="o">/</span> <span class="n">i2</span><span class="p">))),</span> <span class="n">i3</span><span class="p">)}}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mf">0.7</span><span class="o">%</span>    <span class="mf">84.8</span><span class="o">%</span>       <span class="mf">0.001</span><span class="n">s</span>       <span class="mf">6.59e-07</span><span class="n">s</span>   <span class="mi">1000</span>    <span class="mi">42</span>   <span class="n">Sum</span><span class="p">{</span><span class="n">acc_dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">}(</span><span class="n">Elemwise</span><span class="p">{</span><span class="n">Switch</span><span class="p">}</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="o">...</span> <span class="p">(</span><span class="n">remaining</span> <span class="mi">35</span> <span class="n">Apply</span> <span class="n">instances</span> <span class="n">account</span> <span class="k">for</span> <span class="mf">15.20</span><span class="o">%</span><span class="p">(</span><span class="mf">0.01</span><span class="n">s</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">runtime</span><span class="p">)</span>
</pre></div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, John Salvatier, Christopher Fonnesbeck, Thomas Wiecki.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>